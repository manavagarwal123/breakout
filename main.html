<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniConnect+ - University Networking Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: #6366f1;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .swipe-card {
            cursor: grab;
            user-select: none;
        }
        
        .swipe-card:active {
            cursor: grabbing;
        }
        
        .notification-badge {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .modal-backdrop {
            backdrop-filter: blur(8px);
            background-color: rgba(0, 0, 0, 0.4);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6, #6366f1, #8b5cf6);
            background-size: 200% 100%;
            animation: gradient 2s ease infinite;
        }
        
        @keyframes gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .floating-action {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .locked-feature {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .auth-required {
            position: relative;
        }
        
        .auth-required::before {
            content: "Login Required";
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 1000;
        }
        
        .auth-required:hover::before {
            opacity: 1;
        }
        
        /* Enhanced like button styling */
        .like-btn {
            position: relative;
        }
        
        .like-btn:hover .like-count {
            color: #ef4444;
            font-weight: 600;
        }
        
        .like-btn .fa-heart {
            transition: all 0.3s ease;
        }
        
        .like-btn:hover .fa-heart {
            transform: scale(1.2);
        }
        
        .like-btn .fa-heart.text-red-500 {
            animation: heartBeat 0.6s ease-in-out;
        }
        
        .like-btn.liked {
            color: #ef4444;
        }
        
        .like-btn.liked .fa-heart {
            color: #ef4444 !important;
        }
        
        .like-count {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .like-count:hover {
            text-decoration: underline;
            transform: scale(1.05);
        }
        
        .like-indicator {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        @keyframes heartBeat {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.3);
            }
            100% {
                transform: scale(1);
            }
        }
        
        /* University dropdown styling */
        .university-option {
            transition: all 0.2s ease;
        }
        
        .university-option:hover {
            background-color: #f3f4f6;
        }
        
        .university-option.selected {
            background-color: #e0e7ff;
            color: #3730a3;
        }
        
        #university-dropdown {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f1f5f9;
        }
        
        #university-dropdown::-webkit-scrollbar {
            width: 6px;
        }
        
        #university-dropdown::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        
        #university-dropdown::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        #university-dropdown::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Delete button styling */
        .delete-btn {
            transition: all 0.2s ease;
        }
        
        .delete-btn:hover {
            transform: scale(1.05);
        }
        
        /* Question deletion animation */
        .question-card {
            transition: all 0.3s ease;
        }
        
        /* Delete confirmation modal animations */
        #delete-confirmation-modal {
            animation: fadeIn 0.3s ease-out;
        }
        
        #delete-confirmation-modal .bg-white {
            animation: slideInUp 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .chat-bubble {
            animation: slideInUp 0.3s ease-out;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-10 h-10 gradient-bg rounded-lg flex items-center justify-center">
                            <i class="fas fa-graduation-cap text-white text-lg"></i>
                        </div>
                        <span class="text-xl font-bold text-gray-800">UniConnect+</span>
                    </div>
                    <div class="hidden md:flex space-x-6 ml-10">
                        <button id="nav-home" class="nav-item text-indigo-600 font-medium">Home</button>
                        <button id="nav-questions" class="nav-item text-gray-700 hover:text-indigo-600">Questions</button>
                        <button id="nav-connect" class="nav-item text-gray-700 hover:text-indigo-600">Smart Connect</button>
                        <button id="nav-timeline" class="nav-item text-gray-700 hover:text-indigo-600">Career Timeline</button>
                        <button id="nav-ama" class="nav-item text-gray-700 hover:text-indigo-600">AMA Sessions</button>
                        <button id="nav-mentorship" class="nav-item text-gray-700 hover:text-indigo-600">Mentorship</button>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button id="notification-btn" class="p-2 text-gray-700 hover:text-indigo-600 relative">
                            <i class="fas fa-bell text-lg"></i>
                            <span class="notification-badge absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">3</span>
                        </button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center">
                            <span id="user-avatar" class="text-white text-sm font-medium">U</span>
                        </div>
                        <span id="user-name" class="text-sm font-medium text-gray-700 hidden">Welcome!</span>
                        <div id="session-status" class="text-xs text-gray-500 hidden">
                            <span id="session-time"></span>
                        </div>
                        <button id="logout-btn" class="hidden p-2 text-gray-700 hover:text-red-600 transition-colors" title="Logout">
                            <i class="fas fa-sign-out-alt text-lg"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Login Page -->
    <div id="login-page" class="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 flex items-center justify-center px-4 py-12">
        <div class="max-w-md w-full space-y-8">
            <!-- Logo and Title -->
            <div class="text-center">
                <div class="mx-auto w-20 h-20 gradient-bg rounded-2xl flex items-center justify-center mb-6">
                    <i class="fas fa-graduation-cap text-white text-3xl"></i>
                </div>
                <h2 class="text-3xl font-bold text-gray-900 mb-2">🔐 Secure Login</h2>
                <p class="text-gray-600">Sign in to access UniConnect+ features</p>
                <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <p class="text-sm text-blue-800">
                        <i class="fas fa-shield-alt mr-2"></i>
                        All features are locked until authentication
                    </p>
                </div>
            </div>

            <!-- Login Form -->
            <div class="bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
                <form id="login-form" class="space-y-6">
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-envelope text-gray-400"></i>
                            </div>
                            <input 
                                id="email" 
                                name="email" 
                                type="email" 
                                required 
                                class="w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors"
                                placeholder="Enter your email"
                            >
                        </div>
                    </div>

                    <div>
                        <label for="university" class="block text-sm font-medium text-gray-700 mb-2">University</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-university text-gray-400"></i>
                            </div>
                            <input 
                                id="university-search" 
                                type="text" 
                                placeholder="Search for your university..." 
                                class="w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors"
                                autocomplete="off"
                            >
                            <button 
                                type="button" 
                                id="university-dropdown-toggle" 
                                class="absolute inset-y-0 right-0 pr-3 flex items-center"
                            >
                                <i class="fas fa-chevron-down text-gray-400 hover:text-gray-600"></i>
                            </button>
                            <div id="university-dropdown" class="absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto hidden">
                                <!-- University options will be populated here -->
                            </div>
                            <input 
                                id="university" 
                                name="university" 
                                type="hidden" 
                                required
                            >
                        </div>
                    </div>

                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-lock text-gray-400"></i>
                            </div>
                            <input 
                                id="password" 
                                name="password" 
                                type="password" 
                                required 
                                class="w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors"
                                placeholder="Enter your password"
                            >
                            <button 
                                type="button" 
                                id="toggle-password" 
                                class="absolute inset-y-0 right-0 pr-3 flex items-center"
                            >
                                <i class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                            </button>
                        </div>
                    </div>

                     <div>
                         <label for="role" class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                         <select id="role" name="role" required class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                             <option value="">Select role</option>
                             <option value="Student">Student</option>
                             <option value="Alumni">Alumni</option>
                             <option value="Mentor">Mentor</option>
                         </select>
                     </div>

                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input 
                                id="remember-me" 
                                name="remember-me" 
                                type="checkbox" 
                                class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
                            >
                            <label for="remember-me" class="ml-2 block text-sm text-gray-700">Remember me</label>
                        </div>
                        <a href="#" class="text-sm text-indigo-600 hover:text-indigo-500 font-medium">Forgot password?</a>
                    </div>

                    <button 
                        type="submit" 
                        class="w-full bg-indigo-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors duration-200"
                    >
                        <span id="login-btn-text">Sign In</span>
                        <div id="login-loading" class="hidden">
                            <i class="fas fa-spinner fa-spin mr-2"></i>Signing in...
                        </div>
                    </button>
                </form>

                <!-- Divider -->
                <div class="mt-6">
                    <div class="relative">
                        <div class="absolute inset-0 flex items-center">
                            <div class="w-full border-t border-gray-300"></div>
                        </div>
                        <div class="relative flex justify-center text-sm">
                            <span class="px-2 bg-white text-gray-500">Or continue with</span>
                        </div>
                    </div>
                </div>

                <!-- Social Login Buttons -->
                <div class="mt-6 grid grid-cols-2 gap-3">
                    <button class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors">
                        <i class="fab fa-google text-red-500 mr-2"></i>
                        Google
                    </button>
                    <button class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors">
                        <i class="fab fa-linkedin text-blue-600 mr-2"></i>
                        LinkedIn
                    </button>
                </div>

                <!-- Sign Up Link -->
                <div class="mt-6 text-center">
                    <p class="text-sm text-gray-600">
                        Don't have an account? 
                        <a href="#" id="signup-link" class="font-medium text-indigo-600 hover:text-indigo-500">Sign up</a>
                    </p>
                </div>
            </div>

            <!-- Additional Info -->
            <div class="text-center">
                <p class="text-xs text-gray-500">
                    By signing in, you agree to our 
                    <a href="#" class="text-indigo-600 hover:text-indigo-500">Terms of Service</a> 
                    and 
                    <a href="#" class="text-indigo-600 hover:text-indigo-500">Privacy Policy</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <!-- Landing Page -->
        <div id="landing-page" class="space-y-8">
            <!-- Hero Section -->
            <div class="gradient-bg rounded-2xl p-8 text-white">
                <div class="flex flex-col lg:flex-row items-center justify-between">
                    <div class="lg:w-1/2 mb-6 lg:mb-0">
                        <h1 class="text-4xl lg:text-5xl font-bold mb-4">Welcome to UniConnect+</h1>
                        <p class="text-xl opacity-90 mb-6">Connect, Learn, and Grow with your university community. Get instant answers, find mentors, and accelerate your career.</p>
                        <div class="flex space-x-4">
                            <button id="get-started-btn" class="bg-white text-indigo-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">Get Started</button>
                            <button class="border border-white text-white px-6 py-3 rounded-lg font-semibold hover:bg-white hover:bg-opacity-10 transition">Learn More</button>
                        </div>
                    </div>
                    <div class="lg:w-1/2 flex justify-center">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white bg-opacity-20 rounded-lg p-4 card-hover">
                                <i class="fas fa-question-circle text-3xl mb-2"></i>
                                <h3 class="font-semibold">Ask Questions</h3>
                                <p class="text-sm opacity-80">Get instant help from seniors and alumni</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-lg p-4 card-hover">
                                <i class="fas fa-users text-3xl mb-2"></i>
                                <h3 class="font-semibold">Smart Connect</h3>
                                <p class="text-sm opacity-80">AI-powered networking with relevant people</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-lg p-4 card-hover">
                                <i class="fas fa-video text-3xl mb-2"></i>
                                <h3 class="font-semibold">AMA Sessions</h3>
                                <p class="text-sm opacity-80">Live sessions with industry experts</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-lg p-4 card-hover">
                                <i class="fas fa-trophy text-3xl mb-2"></i>
                                <h3 class="font-semibold">Gamified Learning</h3>
                                <p class="text-sm opacity-80">Earn badges and climb leaderboards</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-md card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm">Active Users</p>
                            <p class="text-2xl font-bold text-gray-900">2,847</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-blue-600 text-xl"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm">Questions Answered</p>
                            <p class="text-2xl font-bold text-gray-900">15,392</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check-circle text-green-600 text-xl"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm">Successful Connections</p>
                            <p class="text-2xl font-bold text-gray-900">8,756</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-handshake text-purple-600 text-xl"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm">AMA Sessions</p>
                            <p class="text-2xl font-bold text-gray-900">247</p>
                        </div>
                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-video text-yellow-600 text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Questions Page -->
        <div id="questions-page" class="hidden space-y-6">
            <div class="flex flex-col lg:flex-row gap-6">
                <!-- Main Questions Feed -->
                <div class="lg:w-2/3 space-y-6">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-2xl font-bold text-gray-900">Ask a Question</h2>
                            <div class="flex items-center space-x-3">
                                <label class="text-sm font-medium text-gray-700">Filter:</label>
                                <select id="university-filter" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm">
                                    <option value="global">🌍 Global</option>
                                    <option value="university" id="user-university-option">🎓 My University</option>
                                </select>
                                <div id="filter-indicator" class="px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800">
                                    <span id="filter-text">Global</span>
                                </div>
                            </div>
                        </div>
                        <form id="question-form" class="space-y-4">
                            <input id="question-title" type="text" placeholder="What's your question about?" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" required>
                            <textarea id="question-content" placeholder="Describe your question in detail..." rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" required></textarea>
                            <div class="flex flex-wrap gap-2">
                                <span class="tag-option px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full cursor-pointer hover:bg-blue-200" data-tag="Career">Career</span>
                                <span class="tag-option px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full cursor-pointer hover:bg-green-200" data-tag="Academics">Academics</span>
                                <span class="tag-option px-3 py-1 bg-purple-100 text-purple-800 text-sm rounded-full cursor-pointer hover:bg-purple-200" data-tag="Internships">Internships</span>
                                <span class="tag-option px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-full cursor-pointer hover:bg-yellow-200" data-tag="Placements">Placements</span>
                            </div>
                            <div class="flex items-center space-x-4">
                                <button type="submit" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition">Post Question</button>
                            </div>
                        </form>
                    </div>

                    <!-- Questions Feed -->
                    <div id="questions-feed" class="space-y-4">
                        <!-- Dynamic questions will be loaded here by QuestionManager -->
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="lg:w-1/3 space-y-6">
                    <!-- Trending Topics -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">🔥 Trending Topics</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Google Internship 2024</span>
                                <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">47 posts</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Machine Learning Projects</span>
                                <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">32 posts</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Campus Placements</span>
                                <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">28 posts</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Resume Review</span>
                                <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">23 posts</span>
                            </div>
                        </div>
                    </div>

                    <!-- Top Contributors -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">⭐ Top Contributors</h3>
                        <div class="space-y-4">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center">
                                    <span class="text-white text-xs font-medium">S</span>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Suresh Kumar</p>
                                    <p class="text-xs text-gray-600">Career Guru • 247 pts</p>
                                </div>
                                <div class="text-yellow-500">
                                    <i class="fas fa-crown"></i>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                    <span class="text-white text-xs font-medium">M</span>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Maya Reddy</p>
                                    <p class="text-xs text-gray-600">Resume Reviewer • 189 pts</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center">
                                    <span class="text-white text-xs font-medium">K</span>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Karan Singh</p>
                                    <p class="text-xs text-gray-600">Tech Mentor • 156 pts</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Smart Connect Page -->
        <div id="connect-page" class="hidden space-y-6">
            <div class="flex flex-col lg:flex-row gap-6">
                <!-- AI Email Generator -->
                <div class="lg:w-1/2">
                    <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                        <h2 class="text-2xl font-bold text-gray-900 mb-4">🤖 AI Email Generator</h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Your Goal</label>
                                <input type="text" id="goal" placeholder="e.g., Seeking internship guidance for UX design" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Who are you contacting?</label>
                                <input type="text" id="contact" placeholder="e.g., Ananya Kumar, UX Designer at Adobe" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Additional Context</label>
                                <textarea id="context" placeholder="Any specific details you want to mention..." rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"></textarea>
                            </div>
                            <button id="generate-email-btn" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition">Generate Email</button>
                        </div>
                    </div>

                    <!-- Generated Email Preview -->
                    <div id="email-preview" class="bg-white rounded-xl shadow-md p-6 hidden">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">📧 Generated Email</h3>
                        <div id="user-info" class="bg-blue-50 border-l-4 border-blue-400 p-3 mb-4 rounded">
                            <p class="text-sm text-blue-800">
                                <strong>From:</strong> <span id="user-name-display">User</span> • <span id="user-university-display">University</span>
                            </p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg mb-4">
                            <div id="email-content" class="text-sm text-gray-700 whitespace-pre-line border-2 border-dashed border-gray-300 p-3 rounded-lg transition-all duration-200 hover:border-indigo-400">
                                Subject: Seeking UX Design Guidance from a CU Alumna

Hi Ananya,

I hope this email finds you well. I'm Rahul Sharma, a 2nd-year Computer Science student at Chandigarh University. I came across your inspiring journey from CU to becoming a UX Designer at Adobe, and I'm really impressed by your work on the Creative Suite redesign project.

I'm passionate about UX design and am actively working on building my portfolio with projects in mobile app design and user research. As someone who has successfully transitioned from our university to the industry, I would greatly appreciate any guidance you could share about:

- Essential skills for UX design roles
- How to build a compelling portfolio
- Internship opportunities at companies like Adobe

I understand you must be busy, but even a 15-minute conversation would be incredibly valuable for my career journey. I'm happy to work around your schedule.

Thank you for considering my request. Looking forward to your response.

Best regards,
Rahul Sharma
CSE 2nd Year, Chandigarh University
rahul.sharma@cu.ac.in
                            </div>
                            <div class="text-xs text-gray-500 mt-2 italic">
                                💡 <strong>Tip:</strong> Click anywhere on the email above to edit it before sending!
                            </div>
                        </div>
                        <div class="flex space-x-3">
                            <button id="copy-email-btn" class="flex-1 bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700 transition">
                                <i class="fas fa-copy mr-2"></i>Copy Email
                            </button>
                            <button id="send-email-btn" class="flex-1 bg-purple-600 text-white py-2 rounded-lg font-medium hover:bg-purple-700 transition">
                                <i class="fas fa-paper-plane mr-2"></i>Send Email
                            </button>
                            <button class="flex-1 bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition">
                                <i class="fab fa-linkedin mr-2"></i>Open LinkedIn
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Smart Matching -->
                <div class="lg:w-1/2">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-2xl font-bold text-gray-900 mb-4">🎯 Smart Connect Recommendations</h2>
                        <div class="mb-4">
                            <input type="text" placeholder="What are you looking for help with?" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                        </div>
                        
                        <!-- Match Cards -->
                        <div id="match-cards" class="space-y-4 max-h-96 overflow-y-auto">
                            <!-- Match 1 -->
                            <div class="swipe-card border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-md transition">
                                <div class="flex items-start justify-between mb-3">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center">
                                            <span class="text-white font-medium">A</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-900">Ananya Kumar</h4>
                                            <p class="text-sm text-gray-600">UX Designer at Adobe • CU Alumni 2020</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-1">
                                        <span class="text-sm text-yellow-600">98% match</span>
                                        <i class="fas fa-star text-yellow-400"></i>
                                    </div>
                                </div>
                                <p class="text-sm text-gray-700 mb-3">Specializes in mobile app design and user research. Active mentor for CU students interested in UX career paths.</p>
                                <div class="flex flex-wrap gap-2 mb-3">
                                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">UX Design</span>
                                    <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full">Adobe Creative Suite</span>
                                    <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Mentoring</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="flex-1 bg-indigo-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-indigo-700 transition">Connect</button>
                                    <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition">
                                        <i class="fas fa-heart text-gray-400"></i>
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500 mt-2 italic">"Hi! I'm also passionate about UX design and preparing for internships. Would love to connect and learn from your experience at Adobe!"</p>
                            </div>

                            <!-- Match 2 -->
                            <div class="swipe-card border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-md transition">
                                <div class="flex items-start justify-between mb-3">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center">
                                            <span class="text-white font-medium">R</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-900">Rohit Gupta</h4>
                                            <p class="text-sm text-gray-600">SDE at Google • CU Alumni 2019</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-1">
                                        <span class="text-sm text-yellow-600">95% match</span>
                                        <i class="fas fa-star text-yellow-400"></i>
                                    </div>
                                </div>
                                <p class="text-sm text-gray-700 mb-3">Google SDE with expertise in system design and algorithms. Regularly conducts mock interviews for placement preparation.</p>
                                <div class="flex flex-wrap gap-2 mb-3">
                                    <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">System Design</span>
                                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">Algorithms</span>
                                    <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">Interview Prep</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="flex-1 bg-indigo-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-indigo-700 transition">Connect</button>
                                    <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition">
                                        <i class="fas fa-heart text-gray-400"></i>
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500 mt-2 italic">"Hey! I'm also preparing for Google interviews. Would appreciate your insights on system design and coding rounds!"</p>
                            </div>

                            <!-- Match 3 -->
                            <div class="swipe-card border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-md transition">
                                <div class="flex items-start justify-between mb-3">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center">
                                            <span class="text-white font-medium">S</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-900">Sneha Patel</h4>
                                            <p class="text-sm text-gray-600">Data Scientist at Microsoft • CU Alumni 2021</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-1">
                                        <span class="text-sm text-yellow-600">92% match</span>
                                        <i class="fas fa-star text-yellow-400"></i>
                                    </div>
                                </div>
                                <p class="text-sm text-gray-700 mb-3">ML/AI specialist with publications in top-tier conferences. Helps students with research projects and career guidance.</p>
                                <div class="flex flex-wrap gap-2 mb-3">
                                    <span class="px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full">Machine Learning</span>
                                    <span class="px-2 py-1 bg-pink-100 text-pink-800 text-xs rounded-full">Data Science</span>
                                    <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Research</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="flex-1 bg-indigo-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-indigo-700 transition">Connect</button>
                                    <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition">
                                        <i class="fas fa-heart text-gray-400"></i>
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500 mt-2 italic">"Hi! I'm exploring ML/AI research opportunities. Would love to discuss your journey and get guidance on projects!"</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Career Timeline Page -->
        <div id="timeline-page" class="hidden space-y-6">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">📈 Career Timeline Explorer</h2>
                
                <!-- Filter Options -->
                <div class="flex flex-wrap gap-4 mb-6">
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                        <option>All Domains</option>
                        <option>Software Development</option>
                        <option>Data Science</option>
                        <option>UX/UI Design</option>
                        <option>Product Management</option>
                    </select>
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                        <option>All Companies</option>
                        <option>Google</option>
                        <option>Microsoft</option>
                        <option>Adobe</option>
                        <option>Amazon</option>
                    </select>
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                        <option>All Graduation Years</option>
                        <option>2019</option>
                        <option>2020</option>
                        <option>2021</option>
                        <option>2022</option>
                    </select>
                </div>

                <!-- AI Insights -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-3">🤖 AI Career Insights</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900 mb-2">Common Path to Google</h4>
                            <p class="text-sm text-gray-700">85% of CU alumni at Google completed internships at startups first, then got full-time offers. Average preparation time: 8 months.</p>
                        </div>
                        <div class="bg-white rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900 mb-2">Key Skills for Success</h4>
                            <p class="text-sm text-gray-700">Data structures, system design, and open-source contributions were common among 90% of successful placements.</p>
                        </div>
                    </div>
                </div>

                <!-- Timeline Visualization -->
                <div class="space-y-6">
                    <!-- Timeline Entry 1 -->
                    <div class="flex items-start space-x-6">
                        <div class="flex flex-col items-center">
                            <div class="w-4 h-4 bg-indigo-600 rounded-full"></div>
                            <div class="w-0.5 h-24 bg-gray-300"></div>
                        </div>
                        <div class="flex-1 bg-gray-50 rounded-lg p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-bold text-gray-900">Rohit Gupta's Journey</h3>
                                <span class="px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full">Software Development</span>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div class="bg-white rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-900 text-sm">Year 1-2</h4>
                                    <p class="text-xs text-gray-600 mt-1">DSA Fundamentals</p>
                                    <p class="text-xs text-gray-500">Completed CLRS, solved 200+ problems</p>
                                </div>
                                <div class="bg-white rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-900 text-sm">Year 3</h4>
                                    <p class="text-xs text-gray-600 mt-1">Internship at Startup</p>
                                    <p class="text-xs text-gray-500">Backend development, microservices</p>
                                </div>
                                <div class="bg-white rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-900 text-sm">Final Year</h4>
                                    <p class="text-xs text-gray-600 mt-1">System Design Prep</p>
                                    <p class="text-xs text-gray-500">Mock interviews, open source</p>
                                </div>
                                <div class="bg-white rounded-lg p-4 border-2 border-green-400">
                                    <h4 class="font-semibold text-gray-900 text-sm">Current</h4>
                                    <p class="text-xs text-gray-600 mt-1">SDE at Google</p>
                                    <p class="text-xs text-gray-500">Search Infrastructure Team</p>
                                </div>
                            </div>
                            <div class="mt-4 flex items-center space-x-4">
                                <button class="text-sm text-indigo-600 hover:text-indigo-800">💬 Connect with Rohit</button>
                                <button class="text-sm text-gray-600 hover:text-gray-800">📋 Copy Path</button>
                            </div>
                        </div>
                    </div>

                    <!-- Timeline Entry 2 -->
                    <div class="flex items-start space-x-6">
                        <div class="flex flex-col items-center">
                            <div class="w-4 h-4 bg-purple-600 rounded-full"></div>
                            <div class="w-0.5 h-24 bg-gray-300"></div>
                        </div>
                        <div class="flex-1 bg-gray-50 rounded-lg p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-bold text-gray-900">Ananya Kumar's Journey</h3>
                                <span class="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full">UX Design</span>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div class="bg-white rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-900 text-sm">Year 1-2</h4>
                                    <p class="text-xs text-gray-600 mt-1">Design Basics</p>
                                    <p class="text-xs text-gray-500">UI/UX courses, design thinking</p>
                                </div>
                                <div class="bg-white rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-900 text-sm">Year 3</h4>
                                    <p class="text-xs text-gray-600 mt-1">Portfolio Building</p>
                                    <p class="text-xs text-gray-500">3 major projects, user research</p>
                                </div>
                                <div class="bg-white rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-900 text-sm">Final Year</h4>
                                    <p class="text-xs text-gray-600 mt-1">Internship at Adobe</p>
                                    <p class="text-xs text-gray-500">Creative Suite team, design systems</p>
                                </div>
                                <div class="bg-white rounded-lg p-4 border-2 border-purple-400">
                                    <h4 class="font-semibold text-gray-900 text-sm">Current</h4>
                                    <p class="text-xs text-gray-600 mt-1">UX Designer at Adobe</p>
                                    <p class="text-xs text-gray-500">Creative Cloud Platform</p>
                                </div>
                            </div>
                            <div class="mt-4 flex items-center space-x-4">
                                <button class="text-sm text-indigo-600 hover:text-indigo-800">💬 Connect with Ananya</button>
                                <button class="text-sm text-gray-600 hover:text-gray-800">📋 Copy Path</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AMA Sessions Page -->
        <div id="ama-page" class="hidden space-y-6">
            <div class="flex flex-col lg:flex-row gap-6">
                <!-- Live Sessions -->
                <div class="lg:w-2/3 space-y-6">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-2xl font-bold text-gray-900 mb-6">🔴 Live AMA Sessions</h2>
                        
                        <!-- Featured Live Session -->
                        <div id="live-session-container" class="bg-gradient-to-r from-red-500 to-pink-600 rounded-xl p-6 text-white mb-6 hidden">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center space-x-3">
                                    <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                        <span class="text-white font-bold">LIVE</span>
                                    </div>
                                    <div>
                                        <h3 id="live-session-title" class="text-xl font-bold">Loading...</h3>
                                        <p id="live-session-host" class="text-sm opacity-90">Loading...</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p id="live-session-watchers" class="text-sm opacity-90">👥 Loading...</p>
                                    <p id="live-session-time" class="text-xs opacity-75">Loading...</p>
                                </div>
                            </div>
                            <div class="flex space-x-3">
                                <button id="join-session-btn" class="bg-white text-red-600 px-6 py-2 rounded-lg font-semibold hover:bg-gray-100 transition">Join Session</button>
                                <button class="border border-white text-white px-6 py-2 rounded-lg font-semibold hover:bg-white hover:bg-opacity-10 transition">Ask Question</button>
                            </div>
                        </div>
                        
                        <!-- No Live Session Message -->
                        <div id="no-live-session" class="bg-gray-100 rounded-xl p-6 text-center">
                            <div class="w-16 h-16 bg-gray-300 rounded-full mx-auto mb-4 flex items-center justify-center">
                                <i class="fas fa-video text-gray-500 text-2xl"></i>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-2">No Live Sessions</h3>
                            <p class="text-gray-600">Check back later for live AMA sessions or browse upcoming sessions below.</p>
                        </div>

                        <!-- Live Chat -->
                        <div id="live-chat-container" class="border border-gray-200 rounded-lg p-4 h-64 overflow-y-auto bg-gray-50 mb-4 hidden">
                            <h4 class="font-semibold text-gray-900 mb-3">💬 Live Chat</h4>
                            <div id="chat-messages" class="space-y-3">
                                <!-- Chat messages will be dynamically loaded here -->
                            </div>
                            <div id="typing-indicator" class="typing-indicator hidden">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <span class="text-xs text-gray-500 ml-2"><span id="typing-user">Someone</span> is typing...</span>
                            </div>
                        </div>

                        <!-- Chat Input -->
                        <div id="chat-input-container" class="flex space-x-2 hidden">
                            <input id="chat-input" type="text" placeholder="Ask your question..." class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                            <button id="send-message-btn" class="bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition">Send</button>
                        </div>
                        
                        <!-- Chat Disabled Message -->
                        <div id="chat-disabled" class="bg-gray-100 rounded-lg p-4 text-center">
                            <i class="fas fa-comments text-gray-400 text-2xl mb-2"></i>
                            <p class="text-gray-600">Chat is only available during live sessions</p>
                        </div>
                    </div>

                    <!-- Upcoming Sessions -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">📅 Upcoming Sessions</h3>
                        <div id="upcoming-sessions-container" class="space-y-4">
                            <!-- Upcoming sessions will be dynamically loaded here -->
                        </div>
                        
                        <!-- Loading state -->
                        <div id="upcoming-sessions-loading" class="text-center py-8">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto mb-4"></div>
                            <p class="text-gray-600">Loading upcoming sessions...</p>
                        </div>
                        
                        <!-- No upcoming sessions -->
                        <div id="no-upcoming-sessions" class="text-center py-8 hidden">
                            <div class="w-16 h-16 bg-gray-200 rounded-full mx-auto mb-4 flex items-center justify-center">
                                <i class="fas fa-calendar-times text-gray-400 text-2xl"></i>
                            </div>
                            <h4 class="text-lg font-semibold text-gray-700 mb-2">No Upcoming Sessions</h4>
                            <p class="text-gray-600">Check back later for new AMA sessions!</p>
                        </div>
                    </div>
                </div>

                <!-- Session Highlights & FAQ -->
                <div class="lg:w-1/3 space-y-6">
                    <!-- AI Generated Highlights -->
                    <div id="highlights-container" class="bg-white rounded-xl shadow-md p-6 hidden">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">✨ Session Highlights</h3>
                        <div id="highlights-content" class="space-y-4">
                            <!-- Highlights will be dynamically loaded here -->
                        </div>
                        
                        <!-- Loading state -->
                        <div id="highlights-loading" class="text-center py-4">
                            <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600 mx-auto mb-2"></div>
                            <p class="text-xs text-gray-600">Generating highlights...</p>
                        </div>
                    </div>
                    
                    <!-- No highlights available -->
                    <div id="no-highlights" class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">✨ Session Highlights</h3>
                        <div class="text-center py-4">
                            <div class="w-12 h-12 bg-gray-200 rounded-full mx-auto mb-3 flex items-center justify-center">
                                <i class="fas fa-lightbulb text-gray-400 text-xl"></i>
                            </div>
                            <p class="text-sm text-gray-600">Highlights will appear here when you join a session</p>
                        </div>
                    </div>

                    <!-- Smart FAQ -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">🤖 Smart FAQ</h3>
                        <div class="space-y-3">
                            <details class="group">
                                <summary class="flex justify-between items-center cursor-pointer p-3 bg-gray-50 rounded-lg hover:bg-gray-100">
                                    <span class="text-sm font-medium text-gray-900">How to transition from engineering to PM?</span>
                                    <i class="fas fa-chevron-down group-open:rotate-180 transition-transform"></i>
                                </summary>
                                <div class="p-3 text-sm text-gray-700">
                                    Start by working on cross-functional projects, learning about user research, and building a portfolio showcasing product thinking. Many successful PMs began as engineers.
                                </div>
                            </details>
                            
                            <details class="group">
                                <summary class="flex justify-between items-center cursor-pointer p-3 bg-gray-50 rounded-lg hover:bg-gray-100">
                                    <span class="text-sm font-medium text-gray-900">Best resources for PM interview prep?</span>
                                    <i class="fas fa-chevron-down group-open:rotate-180 transition-transform"></i>
                                </summary>
                                <div class="p-3 text-sm text-gray-700">
                                    Cracking the PM Interview, Lewis Lin's books, and practicing case studies. Focus on frameworks like CIRCLES for design questions.
                                </div>
                            </details>
                            
                            <details class="group">
                                <summary class="flex justify-between items-center cursor-pointer p-3 bg-gray-50 rounded-lg hover:bg-gray-100">
                                    <span class="text-sm font-medium text-gray-900">What metrics matter most for PMs?</span>
                                    <i class="fas fa-chevron-down group-open:rotate-180 transition-transform"></i>
                                </summary>
                                <div class="p-3 text-sm text-gray-700">
                                    User engagement, retention, conversion rates, and business impact metrics. Always tie features to measurable outcomes.
                                </div>
                            </details>
                        </div>
                    </div>

                    <!-- Video Testimonials -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">🎥 Video Testimonials</h3>
                        <div class="space-y-3">
                            <div class="bg-gray-100 rounded-lg p-3 cursor-pointer hover:bg-gray-200 transition">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-red-500 rounded flex items-center justify-center">
                                        <i class="fas fa-play text-white text-xs"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-sm font-medium text-gray-900">Rohit's Placement Journey</h4>
                                        <p class="text-xs text-gray-600">2:34 • 847 views</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-gray-100 rounded-lg p-3 cursor-pointer hover:bg-gray-200 transition">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-red-500 rounded flex items-center justify-center">
                                        <i class="fas fa-play text-white text-xs"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-sm font-medium text-gray-900">UX Design at Adobe</h4>
                                        <p class="text-xs text-gray-600">1:47 • 623 views</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mentorship Page -->
        <div id="mentorship-page" class="hidden space-y-6">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">🎯 Micro-Mentorship Pods</h2>
                
                <!-- Active Pod -->
                <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h3 class="text-xl font-bold text-gray-900">🚀 Google Interview Prep Sprint</h3>
                            <p class="text-sm text-gray-600">Week 2 of 4 • 5 members • Mentor: Rohit Gupta</p>
                        </div>
                        <div class="text-right">
                            <div class="progress-bar h-2 w-24 rounded-full mb-1"></div>
                            <p class="text-xs text-gray-600">50% Complete</p>
                        </div>
                    </div>
                    
                    <!-- Pod Members -->
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
                        <div class="bg-white rounded-lg p-3 text-center">
                            <div class="w-12 h-12 bg-blue-500 rounded-full mx-auto mb-2 flex items-center justify-center">
                                <span class="text-white font-medium">R</span>
                            </div>
                            <p class="text-sm font-medium text-gray-900">Rohit</p>
                            <p class="text-xs text-gray-600">Mentor</p>
                            <div class="flex justify-center mt-1">
                                <div class="w-2 h-2 bg-green-400 rounded-full"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-3 text-center">
                            <div class="w-12 h-12 bg-purple-500 rounded-full mx-auto mb-2 flex items-center justify-center">
                                <span class="text-white font-medium">A</span>
                            </div>
                            <p class="text-sm font-medium text-gray-900">Ananya</p>
                            <p class="text-xs text-gray-600">You</p>
                            <div class="flex justify-center mt-1">
                                <div class="w-2 h-2 bg-green-400 rounded-full"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-3 text-center">
                            <div class="w-12 h-12 bg-green-500 rounded-full mx-auto mb-2 flex items-center justify-center">
                                <span class="text-white font-medium">S</span>
                            </div>
                            <p class="text-sm font-medium text-gray-900">Shweta</p>
                            <p class="text-xs text-gray-600">CSE Final</p>
                            <div class="flex justify-center mt-1">
                                <div class="w-2 h-2 bg-yellow-400 rounded-full"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-3 text-center">
                            <div class="w-12 h-12 bg-red-500 rounded-full mx-auto mb-2 flex items-center justify-center">
                                <span class="text-white font-medium">K</span>
                            </div>
                            <p class="text-sm font-medium text-gray-900">Karan</p>
                            <p class="text-xs text-gray-600">CSE 3rd</p>
                            <div class="flex justify-center mt-1">
                                <div class="w-2 h-2 bg-green-400 rounded-full"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-3 text-center">
                            <div class="w-12 h-12 bg-yellow-500 rounded-full mx-auto mb-2 flex items-center justify-center">
                                <span class="text-white font-medium">V</span>
                            </div>
                            <p class="text-sm font-medium text-gray-900">Varun</p>
                            <p class="text-xs text-gray-600">CSE Final</p>
                            <div class="flex justify-center mt-1">
                                <div class="w-2 h-2 bg-red-400 rounded-full"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Weekly Goal -->
                    <div class="bg-white rounded-lg p-4 mb-4">
                        <h4 class="font-semibold text-gray-900 mb-2">📝 This Week's Goal</h4>
                        <p class="text-sm text-gray-700 mb-3">Complete system design practice problems and conduct 2 mock interviews with peer partners.</p>
                        <div class="flex space-x-2">
                            <button class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-indigo-700 transition">Join Group Chat</button>
                            <button class="bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition">Schedule Mock Interview</button>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="bg-white rounded-lg p-4">
                        <h4 class="font-semibold text-gray-900 mb-3">🔥 Recent Activity</h4>
                        <div class="space-y-2 text-sm">
                            <p class="text-gray-700">• Karan shared a system design solution for "Design WhatsApp"</p>
                            <p class="text-gray-700">• Rohit scheduled group session for tomorrow 7 PM</p>
                            <p class="text-gray-700">• Shweta completed mock interview with Varun</p>
                        </div>
                    </div>
                </div>
                
                <!-- Available Pods -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white border border-gray-200 rounded-xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-gray-900">Data Science Bootcamp</h3>
                            <span class="px-3 py-1 bg-purple-100 text-purple-800 text-xs rounded-full">Starting Soon</span>
                        </div>
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center">
                                <span class="text-white font-medium text-sm">S</span>
                            </div>
                            <div>
                                <p class="font-medium text-gray-900">Sneha Patel</p>
                                <p class="text-sm text-gray-600">Microsoft Data Scientist</p>
                            </div>
                        </div>
                        <p class="text-sm text-gray-700 mb-4">6-week intensive program covering ML algorithms, data preprocessing, and real-world projects. Perfect for beginners.</p>
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-sm text-gray-600">
                                <p>Duration: 6 weeks</p>
                                <p>Spots: 2/5 filled</p>
                            </div>
                            <div class="text-sm text-gray-600">
                                <p>Starts: March 20</p>
                                <p>Time: Weekends</p>
                            </div>
                        </div>
                        <button class="w-full bg-purple-600 text-white py-2 rounded-lg font-medium hover:bg-purple-700 transition">Join Pod</button>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-gray-900">UX Portfolio Review</h3>
                            <span class="px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">3 weeks</span>
                        </div>
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center">
                                <span class="text-white font-medium text-sm">A</span>
                            </div>
                            <div>
                                <p class="font-medium text-gray-900">Ananya Kumar</p>
                                <p class="text-sm text-gray-600">Adobe UX Designer</p>
                            </div>
                        </div>
                        <p class="text-sm text-gray-700 mb-4">Intensive portfolio building and review sessions. Focus on case studies, user research documentation, and presentation skills.</p>
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-sm text-gray-600">
                                <p>Duration: 3 weeks</p>
                                <p>Spots: 4/5 filled</p>
                            </div>
                            <div class="text-sm text-gray-600">
                                <p>Starts: March 25</p>
                                <p>Time: Evenings</p>
                            </div>
                        </div>
                        <button class="w-full bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition">Join Pod</button>
                    </div>
                </div>
                
                <!-- Resource Sharing -->
                <div class="mt-6 bg-white rounded-xl shadow-md p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">📚 Shared Resources</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="flex items-center space-x-3 mb-2">
                                <i class="fas fa-file-pdf text-red-500"></i>
                                <h4 class="font-medium text-gray-900 text-sm">System Design Primer</h4>
                            </div>
                            <p class="text-xs text-gray-600 mb-2">Shared by Rohit • Google Interview Prep</p>
                            <button class="text-xs text-indigo-600 hover:text-indigo-800">Download</button>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="flex items-center space-x-3 mb-2">
                                <i class="fas fa-link text-blue-500"></i>
                                <h4 class="font-medium text-gray-900 text-sm">Mock Interview Platform</h4>
                            </div>
                            <p class="text-xs text-gray-600 mb-2">Shared by Sneha • DS Bootcamp</p>
                            <button class="text-xs text-indigo-600 hover:text-indigo-800">Open Link</button>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="flex items-center space-x-3 mb-2">
                                <i class="fas fa-video text-green-500"></i>
                                <h4 class="font-medium text-gray-900 text-sm">UX Case Study Template</h4>
                            </div>
                            <p class="text-xs text-gray-600 mb-2">Shared by Ananya • Portfolio Review</p>
                            <button class="text-xs text-indigo-600 hover:text-indigo-800">Watch</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="floating-action">
        <button id="quick-ask-btn" class="w-14 h-14 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 transition-all hover:scale-110">
            <i class="fas fa-plus text-xl"></i>
        </button>
    </div>

    <!-- Quick Ask Modal -->
    <div id="quick-ask-modal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-md mx-4">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-bold text-gray-900">⚡ Quick Ask</h3>
                <button id="close-modal-btn" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            <div class="space-y-4">
                <textarea placeholder="What do you need help with?" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 resize-none"></textarea>
                <div class="flex flex-wrap gap-2">
                    <button class="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full hover:bg-blue-200 transition">Career Guidance</button>
                    <button class="px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full hover:bg-green-200 transition">Technical Help</button>
                    <button class="px-3 py-1 bg-purple-100 text-purple-800 text-sm rounded-full hover:bg-purple-200 transition">Resume Review</button>
                </div>
                <div class="flex space-x-3">
                    <button class="flex-1 bg-indigo-600 text-white py-2 rounded-lg font-medium hover:bg-indigo-700 transition">Post Question</button>
                    <button class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg font-medium hover:bg-gray-300 transition">Find Mentor</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Create Confirmation Modal -->
    <div id="account-create-modal" class="fixed inset-0 hidden items-center justify-center z-50">
        <div class="absolute inset-0 bg-gradient-to-br from-indigo-600/60 via-purple-600/60 to-pink-500/60 backdrop-blur-sm"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 overflow-hidden">
            <div class="bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 p-5 text-white">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <h3 class="text-lg font-bold">Create New Account</h3>
                    </div>
                    <button id="account-create-close" class="text-white/90 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <div class="flex items-start space-x-3">
                    <div class="w-10 h-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-gray-800 font-semibold mb-1">No account found for:</p>
                        <p class="text-sm text-gray-600"><span id="account-create-email" class="font-mono px-2 py-1 bg-gray-100 rounded"></span></p>
                        <p class="text-sm text-gray-700 mt-3">Do you want to create a new account using this email and the password you entered?</p>
                    </div>
                </div>
                <div class="mt-6 grid grid-cols-2 gap-3">
                    <button id="account-create-confirm" class="bg-green-600 text-white py-2 rounded-lg font-semibold hover:bg-green-700 transition">
                        <i class="fas fa-check mr-2"></i>Create Account
                    </button>
                    <button id="account-create-cancel" class="bg-gray-200 text-gray-800 py-2 rounded-lg font-semibold hover:bg-gray-300 transition">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logout-modal" class="fixed inset-0 hidden items-center justify-center z-50">
        <div class="absolute inset-0 bg-gradient-to-br from-rose-500/60 via-orange-500/60 to-yellow-500/60 backdrop-blur-sm"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 overflow-hidden">
            <div class="bg-gradient-to-r from-rose-500 via-orange-500 to-yellow-500 p-5 text-white">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-sign-out-alt"></i>
                        </div>
                        <h3 class="text-lg font-bold">Confirm Logout</h3>
                    </div>
                    <button id="logout-close" class="text-white/90 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <div class="flex items-start space-x-3">
                    <div class="w-10 h-10 rounded-full bg-rose-100 text-rose-600 flex items-center justify-center">
                        <i class="fas fa-question"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-gray-800 font-semibold mb-1">Are you sure you want to logout?</p>
                        <p class="text-sm text-gray-700">Your session will end, but you can sign back in anytime.</p>
                    </div>
                </div>
                <div class="mt-6 grid grid-cols-2 gap-3">
                    <button id="logout-confirm" class="bg-rose-600 text-white py-2 rounded-lg font-semibold hover:bg-rose-700 transition">
                        <i class="fas fa-check mr-2"></i>Logout
                    </button>
                    <button id="logout-cancel" class="bg-gray-200 text-gray-800 py-2 rounded-lg font-semibold hover:bg-gray-300 transition">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Panel -->
    <div id="notification-panel" class="fixed top-16 right-4 w-80 bg-white rounded-xl shadow-2xl border border-gray-200 hidden z-40">
        <div class="p-4 border-b border-gray-200">
            <h3 class="font-bold text-gray-900">🔔 Notifications</h3>
        </div>
        <div class="max-h-96 overflow-y-auto">
            <div class="p-4 border-b border-gray-100 hover:bg-gray-50">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-check text-white text-xs"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">New Answer to Your Question</p>
                        <p class="text-xs text-gray-600">Rohit answered your Google interview question</p>
                        <p class="text-xs text-gray-500 mt-1">2 minutes ago</p>
                    </div>
                </div>
            </div>
            
            <div class="p-4 border-b border-gray-100 hover:bg-gray-50">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-users text-white text-xs"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">New Connection Match</p>
                        <p class="text-xs text-gray-600">AI found 3 new potential mentors for you</p>
                        <p class="text-xs text-gray-500 mt-1">1 hour ago</p>
                    </div>
                </div>
            </div>
            
            <div class="p-4 border-b border-gray-100 hover:bg-gray-50">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-video text-white text-xs"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">AMA Session Starting</p>
                        <p class="text-xs text-gray-600">"How I got into Meta" starts in 15 minutes</p>
                        <p class="text-xs text-gray-500 mt-1">3 hours ago</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="p-4 border-t border-gray-200">
            <button class="w-full text-sm text-indigo-600 hover:text-indigo-800">View All Notifications</button>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Application State
        let currentPage = 'landing';
        let isSocketConnected = false;
        
        // Dummy data
        const dummyUsers = [
            { id: 1, name: 'Rohit Gupta', role: 'Google SDE', avatar: 'R', expertise: ['System Design', 'Algorithms'] },
            { id: 2, name: 'Ananya Kumar', role: 'Adobe UX Designer', avatar: 'A', expertise: ['UX Design', 'Product Design'] },
            { id: 3, name: 'Sneha Patel', role: 'Microsoft Data Scientist', avatar: 'S', expertise: ['Machine Learning', 'Data Science'] }
        ];
        
        // DOM Elements
        const navItems = document.querySelectorAll('.nav-item');
        const pages = ['login-page', 'landing-page', 'questions-page', 'connect-page', 'timeline-page', 'ama-page', 'mentorship-page'];
        
        // Navigation functionality
        function showPage(pageId) {
            // Check if user is logged in for protected pages
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const protectedPages = ['landing', 'questions', 'connect', 'timeline', 'ama', 'mentorship'];
            
            if (protectedPages.includes(pageId) && !isLoggedIn) {
                showNotification('Please login to access this page', 'error');
                showPage('login');
                return;
            }
            
            // If trying to access login page while already logged in, redirect to landing
            if (pageId === 'login' && isLoggedIn) {
                showPage('landing');
                return;
            }
            
            pages.forEach(page => {
                const element = document.getElementById(page);
                if (element) {
                    element.classList.add('hidden');
                }
            });
            
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
            }
            
            // Update nav active state
            navItems.forEach(item => {
                item.classList.remove('text-indigo-600', 'font-medium');
                item.classList.add('text-gray-700', 'hover:text-indigo-600');
            });
            
            const activeNav = document.getElementById('nav-' + pageId);
            if (activeNav) {
                activeNav.classList.remove('text-gray-700', 'hover:text-indigo-600');
                activeNav.classList.add('text-indigo-600', 'font-medium');
            }
            
            currentPage = pageId;
        }
        
        // University data - Comprehensive list of world universities
        const universities = [
            // United States
            'Harvard University', 'Stanford University', 'Massachusetts Institute of Technology (MIT)', 'University of California, Berkeley', 'Yale University',
            'Princeton University', 'Columbia University', 'University of Pennsylvania', 'University of Chicago', 'Duke University',
            'Northwestern University', 'Johns Hopkins University', 'Dartmouth College', 'Brown University', 'Cornell University',
            'University of Michigan', 'University of California, Los Angeles (UCLA)', 'University of Virginia', 'Georgetown University', 'Carnegie Mellon University',
            'University of Southern California', 'New York University', 'University of Texas at Austin', 'University of Illinois at Urbana-Champaign', 'University of Wisconsin-Madison',
            'University of Washington', 'University of North Carolina at Chapel Hill', 'University of California, San Diego', 'Boston University', 'Rice University',
            
            // United Kingdom
            'University of Oxford', 'University of Cambridge', 'Imperial College London', 'University College London (UCL)', 'London School of Economics and Political Science (LSE)',
            'University of Edinburgh', 'King\'s College London', 'University of Manchester', 'University of Bristol', 'University of Warwick',
            'University of Glasgow', 'University of Birmingham', 'University of Sheffield', 'University of Leeds', 'University of Nottingham',
            'University of Southampton', 'University of York', 'University of Liverpool', 'University of Newcastle', 'University of Durham',
            
            // Canada
            'University of Toronto', 'University of British Columbia', 'McGill University', 'University of Alberta', 'University of Waterloo',
            'University of Montreal', 'University of Calgary', 'University of Ottawa', 'Queen\'s University', 'University of Western Ontario',
            'University of Manitoba', 'University of Saskatchewan', 'Dalhousie University', 'University of Victoria', 'Carleton University',
            
            // Australia
            'University of Melbourne', 'Australian National University', 'University of Sydney', 'University of Queensland', 'University of New South Wales',
            'Monash University', 'University of Western Australia', 'University of Adelaide', 'University of Technology Sydney', 'RMIT University',
            'Queensland University of Technology', 'Curtin University', 'Deakin University', 'Griffith University', 'University of Newcastle',
            
            // Germany
            'Technical University of Munich', 'Ludwig Maximilian University of Munich', 'Heidelberg University', 'Humboldt University of Berlin', 'Free University of Berlin',
            'University of Bonn', 'University of Hamburg', 'University of Cologne', 'University of Frankfurt', 'University of Stuttgart',
            'RWTH Aachen University', 'University of Freiburg', 'University of Tübingen', 'University of Göttingen', 'University of Würzburg',
            
            // France
            'Sorbonne University', 'École Normale Supérieure', 'École Polytechnique', 'Sciences Po', 'University of Paris-Saclay',
            'University of Lyon', 'University of Grenoble', 'University of Strasbourg', 'University of Bordeaux', 'University of Toulouse',
            'University of Nice', 'University of Montpellier', 'University of Nantes', 'University of Lille', 'University of Rennes',
            
            // Netherlands
            'University of Amsterdam', 'Delft University of Technology', 'Leiden University', 'Utrecht University', 'Erasmus University Rotterdam',
            'University of Groningen', 'Wageningen University & Research', 'VU University Amsterdam', 'Radboud University', 'Tilburg University',
            
            // Switzerland
            'ETH Zurich', 'University of Zurich', 'University of Geneva', 'University of Basel', 'University of Bern',
            'University of Lausanne', 'University of St. Gallen', 'University of Fribourg', 'University of Neuchâtel', 'University of Lugano',
            
            // Japan
            'University of Tokyo', 'Kyoto University', 'Osaka University', 'Tohoku University', 'Tokyo Institute of Technology',
            'Nagoya University', 'Hokkaido University', 'Kyushu University', 'Waseda University', 'Keio University',
            'Hiroshima University', 'Tokyo University of Science', 'Kobe University', 'Chiba University', 'Yokohama National University',
            
            // China
            'Tsinghua University', 'Peking University', 'Fudan University', 'Shanghai Jiao Tong University', 'Zhejiang University',
            'University of Science and Technology of China', 'Nanjing University', 'Sun Yat-sen University', 'Huazhong University of Science and Technology', 'Sichuan University',
            'Tongji University', 'Beijing Normal University', 'Nankai University', 'Xiamen University', 'Wuhan University',
            
            // India
            'Indian Institute of Technology Bombay', 'Indian Institute of Technology Delhi', 'Indian Institute of Technology Madras', 'Indian Institute of Technology Kanpur', 'Indian Institute of Technology Kharagpur',
            'University of Delhi', 'Jawaharlal Nehru University', 'Banaras Hindu University', 'University of Mumbai', 'University of Calcutta',
            'Anna University', 'Manipal University', 'VIT University', 'Amrita University', 'SRM University',
            'Chandigarh University', 'Lovely Professional University',
            
            // Singapore
            'National University of Singapore', 'Nanyang Technological University', 'Singapore Management University', 'Singapore University of Technology and Design', 'Singapore Institute of Technology',
            
            // South Korea
            'Seoul National University', 'Korea Advanced Institute of Science and Technology', 'Yonsei University', 'Korea University', 'Sungkyunkwan University',
            'Hanyang University', 'Kyung Hee University', 'Pohang University of Science and Technology', 'Ewha Womans University', 'Sogang University',
            
            // Hong Kong
            'University of Hong Kong', 'Chinese University of Hong Kong', 'Hong Kong University of Science and Technology', 'City University of Hong Kong', 'Hong Kong Polytechnic University',
            
            // Taiwan
            'National Taiwan University', 'National Tsing Hua University', 'National Chiao Tung University', 'National Cheng Kung University', 'National Yang Ming Chiao Tung University',
            
            // Brazil
            'University of São Paulo', 'University of Campinas', 'Federal University of Rio de Janeiro', 'Federal University of Minas Gerais', 'University of Brasília',
            
            // Mexico
            'National Autonomous University of Mexico', 'Monterrey Institute of Technology and Higher Education', 'Autonomous University of Nuevo León', 'University of Guadalajara', 'Autonomous University of Yucatán',
            
            // Argentina
            'University of Buenos Aires', 'National University of Córdoba', 'National University of La Plata', 'National University of Rosario', 'National University of Tucumán',
            
            // Chile
            'University of Chile', 'Pontifical Catholic University of Chile', 'University of Concepción', 'University of Santiago', 'University of Valparaíso',
            
            // Colombia
            'National University of Colombia', 'University of Los Andes', 'Pontifical Javeriana University', 'University of Antioquia', 'University of Valle',
            
            // Peru
            'National University of San Marcos', 'Pontifical Catholic University of Peru', 'National University of Engineering', 'University of Lima', 'Cayetano Heredia University',
            
            // South Africa
            'University of Cape Town', 'University of Witwatersrand', 'University of Stellenbosch', 'University of Pretoria', 'University of KwaZulu-Natal',
            
            // Egypt
            'Cairo University', 'Ain Shams University', 'Alexandria University', 'American University in Cairo', 'Zagazig University',
            
            // Nigeria
            'University of Ibadan', 'University of Lagos', 'Ahmadu Bello University', 'University of Nigeria', 'Obafemi Awolowo University',
            
            // Kenya
            'University of Nairobi', 'Kenyatta University', 'Jomo Kenyatta University of Agriculture and Technology', 'Moi University', 'Egerton University',
            
            // Ghana
            'University of Ghana', 'Kwame Nkrumah University of Science and Technology', 'University of Cape Coast', 'University for Development Studies', 'Ashesi University',
            
            // Morocco
            'Mohammed V University', 'Cadi Ayyad University', 'Hassan II University', 'Ibn Zohr University', 'Sidi Mohamed Ben Abdellah University',
            
            // Tunisia
            'University of Tunis', 'University of Sfax', 'University of Monastir', 'University of Gabès', 'University of Gafsa',
            
            // Algeria
            'University of Algiers', 'University of Oran', 'University of Constantine', 'University of Annaba', 'University of Tlemcen',
            
            // Ethiopia
            'Addis Ababa University', 'Bahir Dar University', 'Mekelle University', 'Jimma University', 'Hawassa University',
            
            // Uganda
            'Makerere University', 'Kyambogo University', 'Mbarara University of Science and Technology', 'Gulu University', 'Busitema University',
            
            // Tanzania
            'University of Dar es Salaam', 'Sokoine University of Agriculture', 'University of Dodoma', 'Ardhi University', 'Muhimbili University of Health and Allied Sciences',
            
            // Rwanda
            'University of Rwanda', 'Kigali Institute of Science and Technology', 'National University of Rwanda', 'Kigali Independent University', 'Adventist University of Central Africa',
            
            // Senegal
            'Cheikh Anta Diop University', 'Gaston Berger University', 'Thiès University', 'Ziguinchor University', 'Saint-Louis University',
            
            // Ivory Coast
            'Félix Houphouët-Boigny University', 'University of Abobo-Adjamé', 'University of Bouaké', 'University of Cocody', 'University of Yamoussoukro',
            
            // Cameroon
            'University of Yaoundé', 'University of Douala', 'University of Buea', 'University of Bamenda', 'University of Maroua',
            
            // Democratic Republic of Congo
            'University of Kinshasa', 'University of Lubumbashi', 'University of Kisangani', 'University of Mbuji-Mayi', 'University of Kananga',
            
            // Zambia
            'University of Zambia', 'Copperbelt University', 'Mulungushi University', 'Zambia Open University', 'Evelyn Hone College',
            
            // Zimbabwe
            'University of Zimbabwe', 'National University of Science and Technology', 'Midlands State University', 'Bindura University of Science Education', 'Chinhoyi University of Technology',
            
            // Botswana
            'University of Botswana', 'Botswana International University of Science and Technology', 'Botho University', 'Limpopo University', 'University of South Africa',
            
            // Namibia
            'University of Namibia', 'Namibia University of Science and Technology', 'International University of Management', 'Namibia College of Open Learning', 'University of South Africa',
            
            // Lesotho
            'National University of Lesotho', 'Lerotholi Polytechnic', 'Lesotho College of Education', 'Lesotho Agricultural College', 'Lesotho Institute of Public Administration and Management',
            
            // Eswatini
            'University of Eswatini', 'Eswatini College of Technology', 'Eswatini Institute of Management and Public Administration', 'Eswatini College of Theology', 'Eswatini Institute of Management',
            
            // Madagascar
            'University of Antananarivo', 'University of Fianarantsoa', 'University of Mahajanga', 'University of Toamasina', 'University of Toliara',
            
            // Mauritius
            'University of Mauritius', 'University of Technology Mauritius', 'Mauritius Institute of Education', 'Mauritius College of the Air', 'Mauritius Institute of Health',
            
            // Seychelles
            'University of Seychelles', 'Seychelles Institute of Technology', 'Seychelles Institute of Teacher Education', 'Seychelles Institute of Management', 'Seychelles Institute of Agriculture',
            
            // Comoros
            'University of Comoros', 'Comoros Institute of Technology', 'Comoros Institute of Teacher Education', 'Comoros Institute of Management', 'Comoros Institute of Agriculture',
            
            // Djibouti
            'University of Djibouti', 'Djibouti Institute of Technology', 'Djibouti Institute of Teacher Education', 'Djibouti Institute of Management', 'Djibouti Institute of Agriculture',
            
            // Somalia
            'Mogadishu University', 'University of Hargeisa', 'Puntland State University', 'Somaliland University of Technology', 'University of Somalia',
            
            // Sudan
            'University of Khartoum', 'University of Juba', 'University of Gezira', 'University of Kordofan', 'University of Red Sea',
            
            // South Sudan
            'University of Juba', 'University of Upper Nile', 'University of Bahr el Ghazal', 'University of Rumbek', 'University of Wau',
            
            // Eritrea
            'University of Asmara', 'Eritrea Institute of Technology', 'Eritrea Institute of Teacher Education', 'Eritrea Institute of Management', 'Eritrea Institute of Agriculture',
            
            // Central African Republic
            'University of Bangui', 'Central African Republic Institute of Technology', 'Central African Republic Institute of Teacher Education', 'Central African Republic Institute of Management', 'Central African Republic Institute of Agriculture',
            
            // Chad
            'University of N\'Djamena', 'Chad Institute of Technology', 'Chad Institute of Teacher Education', 'Chad Institute of Management', 'Chad Institute of Agriculture',
            
            // Niger
            'University of Niamey', 'Niger Institute of Technology', 'Niger Institute of Teacher Education', 'Niger Institute of Management', 'Niger Institute of Agriculture',
            
            // Mali
            'University of Bamako', 'Mali Institute of Technology', 'Mali Institute of Teacher Education', 'Mali Institute of Management', 'Mali Institute of Agriculture',
            
            // Burkina Faso
            'University of Ouagadougou', 'Burkina Faso Institute of Technology', 'Burkina Faso Institute of Teacher Education', 'Burkina Faso Institute of Management', 'Burkina Faso Institute of Agriculture',
            
            // Benin
            'University of Abomey-Calavi', 'Benin Institute of Technology', 'Benin Institute of Teacher Education', 'Benin Institute of Management', 'Benin Institute of Agriculture',
            
            // Togo
            'University of Lomé', 'Togo Institute of Technology', 'Togo Institute of Teacher Education', 'Togo Institute of Management', 'Togo Institute of Agriculture',
            
            // Sierra Leone
            'University of Sierra Leone', 'Sierra Leone Institute of Technology', 'Sierra Leone Institute of Teacher Education', 'Sierra Leone Institute of Management', 'Sierra Leone Institute of Agriculture',
            
            // Liberia
            'University of Liberia', 'Liberia Institute of Technology', 'Liberia Institute of Teacher Education', 'Liberia Institute of Management', 'Liberia Institute of Agriculture',
            
            // Guinea
            'University of Conakry', 'Guinea Institute of Technology', 'Guinea Institute of Teacher Education', 'Guinea Institute of Management', 'Guinea Institute of Agriculture',
            
            // Guinea-Bissau
            'University of Bissau', 'Guinea-Bissau Institute of Technology', 'Guinea-Bissau Institute of Teacher Education', 'Guinea-Bissau Institute of Management', 'Guinea-Bissau Institute of Agriculture',
            
            // Cape Verde
            'University of Cape Verde', 'Cape Verde Institute of Technology', 'Cape Verde Institute of Teacher Education', 'Cape Verde Institute of Management', 'Cape Verde Institute of Agriculture',
            
            // Gambia
            'University of The Gambia', 'Gambia Institute of Technology', 'Gambia Institute of Teacher Education', 'Gambia Institute of Management', 'Gambia Institute of Agriculture',
            
            // Mauritania
            'University of Nouakchott', 'Mauritania Institute of Technology', 'Mauritania Institute of Teacher Education', 'Mauritania Institute of Management', 'Mauritania Institute of Agriculture',
            
            // Western Sahara
            'Western Sahara University', 'Western Sahara Institute of Technology', 'Western Sahara Institute of Teacher Education', 'Western Sahara Institute of Management', 'Western Sahara Institute of Agriculture'
        ];

        // University search functionality
        function initializeUniversitySearch() {
            const searchInput = document.getElementById('university-search');
            const dropdown = document.getElementById('university-dropdown');
            const hiddenInput = document.getElementById('university');
            const toggleBtn = document.getElementById('university-dropdown-toggle');
            
            if (!searchInput || !dropdown || !hiddenInput || !toggleBtn) return;
            
            // Show dropdown on input focus
            searchInput.addEventListener('focus', () => {
                showUniversityDropdown();
            });
            
            // Toggle dropdown on button click
            toggleBtn.addEventListener('click', () => {
                if (dropdown.classList.contains('hidden')) {
                    showUniversityDropdown();
                } else {
                    hideUniversityDropdown();
                }
            });
            
            // Search functionality
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                filterUniversities(query);
            });
            
            // Hide dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !dropdown.contains(e.target) && !toggleBtn.contains(e.target)) {
                    hideUniversityDropdown();
                }
            });
            
            // Handle keyboard navigation
            searchInput.addEventListener('keydown', (e) => {
                const visibleOptions = dropdown.querySelectorAll('.university-option:not(.hidden)');
                const currentIndex = Array.from(visibleOptions).findIndex(option => option.classList.contains('selected'));
                
                switch(e.key) {
                    case 'ArrowDown':
                        e.preventDefault();
                        navigateOptions(visibleOptions, currentIndex, 1);
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        navigateOptions(visibleOptions, currentIndex, -1);
                        break;
                    case 'Enter':
                        e.preventDefault();
                        const selectedOption = dropdown.querySelector('.university-option.selected');
                        if (selectedOption) {
                            selectUniversity(selectedOption.textContent);
                        }
                        break;
                    case 'Escape':
                        hideUniversityDropdown();
                        break;
                }
            });
        }
        
        function showUniversityDropdown() {
            const dropdown = document.getElementById('university-dropdown');
            if (dropdown) {
                dropdown.classList.remove('hidden');
                populateUniversityDropdown();
            }
        }
        
        function hideUniversityDropdown() {
            const dropdown = document.getElementById('university-dropdown');
            if (dropdown) {
                dropdown.classList.add('hidden');
            }
        }
        
        function populateUniversityDropdown() {
            const dropdown = document.getElementById('university-dropdown');
            if (!dropdown) return;
            
            dropdown.innerHTML = '';
            universities.forEach(university => {
                const option = document.createElement('div');
                option.className = 'university-option px-4 py-2 hover:bg-gray-100 cursor-pointer text-sm';
                option.textContent = university;
                option.addEventListener('click', () => selectUniversity(university));
                dropdown.appendChild(option);
            });
        }
        
        function filterUniversities(query) {
            const dropdown = document.getElementById('university-dropdown');
            if (!dropdown) return;
            
            const options = dropdown.querySelectorAll('.university-option');
            let hasVisibleOptions = false;
            
            options.forEach(option => {
                const universityName = option.textContent.toLowerCase();
                if (universityName.includes(query)) {
                    option.classList.remove('hidden');
                    hasVisibleOptions = true;
                } else {
                    option.classList.add('hidden');
                }
            });
            
            // Show/hide dropdown based on results
            if (hasVisibleOptions && query.length > 0) {
                dropdown.classList.remove('hidden');
            } else if (query.length === 0) {
                dropdown.classList.remove('hidden');
            } else {
                dropdown.classList.add('hidden');
            }
        }
        
        function selectUniversity(universityName) {
            const searchInput = document.getElementById('university-search');
            const hiddenInput = document.getElementById('university');
            
            if (searchInput && hiddenInput) {
                searchInput.value = universityName;
                hiddenInput.value = universityName;
                hideUniversityDropdown();
                
                // Add visual feedback
                searchInput.classList.add('border-green-500');
                setTimeout(() => {
                    searchInput.classList.remove('border-green-500');
                }, 1000);
            }
        }
        
        function navigateOptions(options, currentIndex, direction) {
            const newIndex = currentIndex + direction;
            if (newIndex >= 0 && newIndex < options.length) {
                // Remove previous selection
                if (currentIndex >= 0 && currentIndex < options.length) {
                    options[currentIndex].classList.remove('selected', 'bg-indigo-100');
                }
                
                // Add new selection
                options[newIndex].classList.add('selected', 'bg-indigo-100');
                options[newIndex].scrollIntoView({ block: 'nearest' });
            }
        }
        
        // Account storage helpers
        function getStoredUsers() {
            const usersJson = localStorage.getItem('users');
            if (!usersJson) return [];
            try { return JSON.parse(usersJson) || []; } catch { return []; }
        }
        function saveStoredUsers(users) {
            localStorage.setItem('users', JSON.stringify(users));
        }
        function findUserByEmail(email) {
            if (!email) return undefined;
            const normalized = String(email).trim().toLowerCase();
            return getStoredUsers().find(u => u.email === normalized);
        }

        // Show contextual hint below email input on login page
        function attachLoginEmailHint() {
            const emailInput = document.getElementById('email');
            if (!emailInput) return;

            // Create hint element if not present
            let hint = document.getElementById('email-hint');
            if (!hint) {
                hint = document.createElement('p');
                hint.id = 'email-hint';
                hint.className = 'mt-1 text-sm';
                // Append after the email field container
                const container = emailInput.parentNode && emailInput.parentNode.parentNode;
                if (container && container.parentNode) {
                    container.parentNode.appendChild(hint);
                }
            }

            const updateHint = () => {
                const value = emailInput.value.trim().toLowerCase();
                if (!value) { hint.textContent = ''; return; }
                if (findUserByEmail(value)) {
                    hint.textContent = 'Account found. Enter your password to login.';
                    hint.className = 'mt-1 text-sm text-green-600';
                } else {
                    hint.textContent = 'No account found. Submit to create one.';
                    hint.className = 'mt-1 text-sm text-gray-500';
                }
            };

            emailInput.addEventListener('blur', updateHint);
            emailInput.addEventListener('input', () => {
                if (hint.textContent) updateHint();
            });
        }

        // Login functionality
        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value.trim().toLowerCase();
            const university = document.getElementById('university').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role')?.value || '';
            const rememberMe = document.getElementById('remember-me').checked;
            
            // Validate university selection
            if (!university) {
                showNotification('Please select your university', 'error');
                document.getElementById('university-search').focus();
                return;
            }
            if (!role) {
                showNotification('Please select your role (Student, Alumni, or Mentor)', 'error');
                document.getElementById('role').focus();
                return;
            }
            
            // Show loading state
            document.getElementById('login-btn-text').classList.add('hidden');
            document.getElementById('login-loading').classList.remove('hidden');
            
            // Simulate login API call
            setTimeout(() => {
                const existingUser = findUserByEmail(email);
                if (!existingUser) {
                    // Show custom account-creation modal
                    openAccountCreateModal({ email, password, rememberMe, university });
                } else if (existingUser.password !== password) {
                    showNotification('Incorrect password. Please try again.', 'error');
                } else {
                    // Update stored user with latest role/university
                    const users = getStoredUsers();
                    const idx = users.findIndex(u => u.email === existingUser.email);
                    if (idx > -1) {
                        users[idx] = { ...users[idx], role, university };
                        saveStoredUsers(users);
                    }
                    // Valid login → store login state
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('userEmail', existingUser.email);
                    localStorage.setItem('userUniversity', university);
                    localStorage.setItem('userRole', role);
                    localStorage.setItem('loginTime', Date.now().toString());
                    localStorage.setItem('currentUser', JSON.stringify({ name: existingUser.name, email: existingUser.email, role, university }));
                    if (rememberMe) {
                        localStorage.setItem('rememberMe', 'true');
                    }
                    showNotification('Login successful!', 'success');
                    setTimeout(() => {
                        showPage('landing');
                        // updateLoginState no longer toggles a navbar login button
                        updateSessionDisplay();
                        updateUserDisplay();
                    }, 1000);
                }
                
                // Reset button state
                document.getElementById('login-btn-text').classList.remove('hidden');
                document.getElementById('login-loading').classList.add('hidden');
            }, 1500);
        }
        
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('password');
            const toggleBtn = document.getElementById('toggle-password');
            const icon = toggleBtn.querySelector('i');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }
        
        function showSignupForm() {
            // For now, just show a simple signup form
            const loginForm = document.getElementById('login-form');
            const signupForm = document.createElement('div');
            signupForm.innerHTML = `
                <div class="space-y-6">
                    <div>
                        <label for="signup-name" class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                        <input id="signup-name" type="text" required class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="signup-email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                        <input id="signup-email" type="email" required class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="signup-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input id="signup-password" type="password" required class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                    </div>
                    <button type="button" id="create-account-btn" class="w-full bg-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-green-700 transition">Create Account</button>
                    <button type="button" id="back-to-login" class="w-full bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition">Back to Login</button>
                </div>
            `;
            
            loginForm.innerHTML = '';
            loginForm.appendChild(signupForm);
            
            // Add event listeners for signup form
            document.getElementById('create-account-btn').addEventListener('click', handleSignup);
            document.getElementById('back-to-login').addEventListener('click', () => {
                location.reload(); // Simple way to restore login form
            });
            // Hint on existing account when typing email
            const signupEmailInput = document.getElementById('signup-email');
            if (signupEmailInput) {
                signupEmailInput.addEventListener('blur', () => {
                    const value = signupEmailInput.value.trim().toLowerCase();
                    if (findUserByEmail(value)) {
                        showNotification('You already have an account. Please login with that email.', 'info');
                    }
                });
            }
        }
        
        function handleSignup() {
            const name = document.getElementById('signup-name').value.trim();
            const emailRaw = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value;
            const email = emailRaw.toLowerCase();
            
            if (!(name && email && password)) {
                showNotification('Please fill all fields', 'error');
                return;
            }
            const users = getStoredUsers();
            const existing = users.find(u => u.email === email);
            if (existing) {
                showNotification('You already have an account. Login with that email.', 'error');
                localStorage.setItem('prefillEmail', email);
                setTimeout(() => { location.reload(); }, 1000);
                return;
            }
            // Default role on signup form (optional later selection on login)
            users.push({ name, email, password, role: 'Student' });
            saveStoredUsers(users);
            showNotification('Account created successfully! Please login.', 'success');
            localStorage.setItem('prefillEmail', email);
            setTimeout(() => { location.reload(); }, 1000);
        }
        
        function updateLoginState() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            // Login button removed, nothing to toggle here
            
            // Update locked features state
            updateLockedFeatures();
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 max-w-md ${
                type === 'success' ? 'bg-green-500 text-white' : 
                type === 'error' ? 'bg-red-500 text-white' : 
                'bg-blue-500 text-white'
            }`;
            
            // Handle multi-line messages
            if (message.includes('\n')) {
                notification.innerHTML = message.split('\n').map(line => 
                    `<div>${line}</div>`
                ).join('');
            } else {
                notification.textContent = message;
            }
            
            document.body.appendChild(notification);
            
            // Longer display time for multi-line messages
            const displayTime = message.includes('\n') ? 5000 : 3000;
            setTimeout(() => {
                notification.remove();
            }, displayTime);
        }
        
        // Custom modal to create account on-the-fly
        function openAccountCreateModal({ email, password, rememberMe, university }) {
            const modal = document.getElementById('account-create-modal');
            const emailSpan = document.getElementById('account-create-email');
            const confirmBtn = document.getElementById('account-create-confirm');
            const cancelBtn = document.getElementById('account-create-cancel');
            const closeBtn = document.getElementById('account-create-close');
            if (!modal || !emailSpan || !confirmBtn || !cancelBtn || !closeBtn) return;
            
            emailSpan.textContent = email;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            const cleanup = () => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
                confirmBtn.onclick = null;
                cancelBtn.onclick = null;
                closeBtn.onclick = null;
            };
            
            cancelBtn.onclick = cleanup;
            closeBtn.onclick = cleanup;
            modal.addEventListener('click', function onBackdrop(e) {
                if (e.target === modal) {
                    cleanup();
                    modal.removeEventListener('click', onBackdrop);
                }
            });
            
            confirmBtn.onclick = () => {
                const users = getStoredUsers();
                const inferredName = email.split('@')[0] || 'User';
                const selectedRole = document.getElementById('role')?.value || 'Student';
                users.push({ name: inferredName, email, password, role: selectedRole, university });
                saveStoredUsers(users);
                showNotification('Account created and signed in.', 'success');
                // proceed as logged in
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('userEmail', email);
                localStorage.setItem('userUniversity', university);
                localStorage.setItem('userRole', selectedRole);
                localStorage.setItem('loginTime', Date.now().toString());
                localStorage.setItem('currentUser', JSON.stringify({ name: inferredName, email, role: selectedRole, university }));
                if (rememberMe) localStorage.setItem('rememberMe', 'true');
                cleanup();
                setTimeout(() => {
                    showPage('landing');
                    // updateLoginState no longer toggles a navbar login button
                    updateSessionDisplay();
                    updateUserDisplay();
                }, 600);
            };
        }

        function openLogoutModal() {
            const modal = document.getElementById('logout-modal');
            const confirmBtn = document.getElementById('logout-confirm');
            const cancelBtn = document.getElementById('logout-cancel');
            const closeBtn = document.getElementById('logout-close');
            if (!modal || !confirmBtn || !cancelBtn || !closeBtn) return;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            const cleanup = () => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
                confirmBtn.onclick = null;
                cancelBtn.onclick = null;
                closeBtn.onclick = null;
            };
            
            cancelBtn.onclick = cleanup;
            closeBtn.onclick = cleanup;
            modal.addEventListener('click', function onBackdrop(e) {
                if (e.target === modal) {
                    cleanup();
                    modal.removeEventListener('click', onBackdrop);
                }
            });
            
            confirmBtn.onclick = () => {
                // Perform logout
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('userEmail');
                localStorage.removeItem('rememberMe');
                localStorage.removeItem('loginTime');
                cleanup();
                showPage('login');
                updateLoginState();
                updateLockedFeatures();
                updateUserDisplay();
                showNotification('Logged out successfully', 'success');
            };
        }
        
        // Authentication check function
        function checkAuth() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const loginTime = localStorage.getItem('loginTime');
            const currentTime = Date.now();
            
            // Check if session has expired (24 hours)
            if (isLoggedIn && loginTime) {
                const sessionDuration = 24 * 60 * 60 * 1000; // 24 hours in milliseconds
                if (currentTime - parseInt(loginTime) > sessionDuration) {
                    // Session expired
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('userEmail');
                    localStorage.removeItem('rememberMe');
                    localStorage.removeItem('loginTime');
                    showNotification('Session expired. Please login again.', 'error');
                    showPage('login');
                    updateLoginState();
                    updateLockedFeatures();
                    updateUserDisplay();
                    return false;
                }
            }
            
            if (!isLoggedIn) {
                showNotification('Please login to access this feature', 'error');
                showPage('login');
                return false;
            }
            return true;
        }
        
        // Update visual state of locked features
        function updateLockedFeatures() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            
            // Navigation items
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (!isLoggedIn) {
                    item.classList.add('locked-feature', 'auth-required');
                    item.style.pointerEvents = 'none';
                } else {
                    item.classList.remove('locked-feature', 'auth-required');
                    item.style.pointerEvents = 'auto';
                }
            });
            
            // Quick ask button
            const quickAskBtn = document.getElementById('quick-ask-btn');
            if (quickAskBtn) {
                if (!isLoggedIn) {
                    quickAskBtn.classList.add('locked-feature', 'auth-required');
                    quickAskBtn.style.pointerEvents = 'none';
                } else {
                    quickAskBtn.classList.remove('locked-feature', 'auth-required');
                    quickAskBtn.style.pointerEvents = 'auto';
                }
            }
            
            // Notification button
            const notificationBtn = document.getElementById('notification-btn');
            if (notificationBtn) {
                if (!isLoggedIn) {
                    notificationBtn.classList.add('locked-feature', 'auth-required');
                    notificationBtn.style.pointerEvents = 'none';
                } else {
                    notificationBtn.classList.remove('locked-feature', 'auth-required');
                    notificationBtn.style.pointerEvents = 'auto';
                }
            }
            
            // Get started button
            const getStartedBtn = document.getElementById('get-started-btn');
            if (getStartedBtn) {
                if (!isLoggedIn) {
                    getStartedBtn.classList.add('locked-feature', 'auth-required');
                    getStartedBtn.style.pointerEvents = 'none';
                } else {
                    getStartedBtn.classList.remove('locked-feature', 'auth-required');
                    getStartedBtn.style.pointerEvents = 'auto';
                }
            }
            

        }
        
        // Session monitoring
        function startSessionMonitoring() {
            // Check session validity every 5 minutes
            setInterval(() => {
                const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
                if (isLoggedIn) {
                    checkAuth(); // This will handle session expiration
                }
            }, 5 * 60 * 1000); // 5 minutes
            
            // Update session time display every minute
            setInterval(() => {
                updateSessionDisplay();
            }, 60 * 1000); // 1 minute
        }
        
        // Update session time display
        function updateSessionDisplay() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const sessionStatus = document.getElementById('session-status');
            const sessionTime = document.getElementById('session-time');
            
            if (isLoggedIn && sessionStatus && sessionTime) {
                const loginTime = localStorage.getItem('loginTime');
                if (loginTime) {
                    const currentTime = Date.now();
                    const elapsed = currentTime - parseInt(loginTime);
                    const hours = Math.floor(elapsed / (1000 * 60 * 60));
                    const minutes = Math.floor((elapsed % (1000 * 60 * 60)) / (1000 * 60));
                    
                    sessionTime.textContent = `Session: ${hours}h ${minutes}m`;
                    sessionStatus.classList.remove('hidden');
                }
            } else if (sessionStatus) {
                sessionStatus.classList.add('hidden');
            }
        }
        
        // Update user display
        function updateUserDisplay() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const userName = document.getElementById('user-name');
            const userAvatar = document.getElementById('user-avatar');
            const logoutBtn = document.getElementById('logout-btn');
            
            if (isLoggedIn && userName && userAvatar) {
                const userEmail = localStorage.getItem('userEmail');
                const role = localStorage.getItem('userRole');
                if (userEmail) {
                    // Extract name from email (first part before @)
                    const name = userEmail.split('@')[0];
                    // Capitalize first letter
                    const displayName = name.charAt(0).toUpperCase() + name.slice(1);
                    
                    userName.textContent = role ? `${displayName} • ${role}` : displayName;
                    userName.classList.remove('hidden');
                    userAvatar.textContent = displayName.charAt(0).toUpperCase();
                }
                
                // Show logout button when logged in
                if (logoutBtn) {
                    logoutBtn.classList.remove('hidden');
                }
            } else if (userName && userAvatar) {
                userName.classList.add('hidden');
                userAvatar.textContent = 'U';
                
                // Hide logout button when not logged in
                if (logoutBtn) {
                    logoutBtn.classList.add('hidden');
                }
            }
        }
        
        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Show login page by default
            showPage('login');
            // Prefill email if present (after signup or hint)
            const prefill = localStorage.getItem('prefillEmail');
            if (prefill) {
                const emailInput = document.getElementById('email');
                if (emailInput) emailInput.value = prefill;
                localStorage.removeItem('prefillEmail');
            }
            
            // Navigation events with authentication checks
            document.getElementById('nav-home').addEventListener('click', () => {
                if (checkAuth()) showPage('landing');
            });
            document.getElementById('nav-questions').addEventListener('click', () => {
                if (checkAuth()) showPage('questions');
            });
            document.getElementById('nav-connect').addEventListener('click', () => {
                if (checkAuth()) showPage('connect');
            });
            document.getElementById('nav-timeline').addEventListener('click', () => {
                if (checkAuth()) showPage('timeline');
            });
            document.getElementById('nav-ama').addEventListener('click', () => {
                if (checkAuth()) showPage('ama');
            });
            document.getElementById('nav-mentorship').addEventListener('click', () => {
                if (checkAuth()) showPage('mentorship');
            });
            
            // Logout button
            document.getElementById('logout-btn').addEventListener('click', () => {
                openLogoutModal();
            });
            
            // Get started button
            document.getElementById('get-started-btn').addEventListener('click', () => {
                if (checkAuth()) showPage('questions');
            });
            
            // Login button removed; if accessed from other UI elements, route to login page
            
            // Login form submission
            document.getElementById('login-form').addEventListener('submit', handleLogin);

            // Show email hint on login page
            attachLoginEmailHint();
            
            // Toggle password visibility
            document.getElementById('toggle-password').addEventListener('click', togglePasswordVisibility);
            
            // Initialize university search functionality
            initializeUniversitySearch();
            
            // Sign up link
            document.getElementById('signup-link').addEventListener('click', (e) => {
                e.preventDefault();
                showSignupForm();
            });
            
            // Email generation
            document.getElementById('generate-email-btn').addEventListener('click', async function() {
                if (checkAuth()) {
                    const btn = this;
                    const originalText = btn.textContent;
                    
                    // Get form data
                    const goal = document.getElementById('goal').value.trim();
                    const contact = document.getElementById('contact').value.trim();
                    const context = document.getElementById('context').value.trim();
                    
                    // Retrieve user credentials from localStorage
                    const userEmail = localStorage.getItem('userEmail');
                    const userUniversity = localStorage.getItem('userUniversity');
                    const userRole = localStorage.getItem('userRole') || 'Student';
                    
                    // Extract user name from email (e.g., 'rahul@example.com' becomes 'Rahul')
                    let userName = 'User';
                    if (userEmail) {
                        userName = userEmail.split('@')[0];
                        // Capitalize first letter
                        userName = userName.charAt(0).toUpperCase() + userName.slice(1);
                    }
                    
                    // Validate required fields
                    if (!goal || !contact) {
                        showNotification('Please fill in both Goal and Contact fields', 'error');
                        return;
                    }
                    
                    // Check if user is logged in and has university info
                    if (!userEmail || !userUniversity) {
                        showNotification('Please log in and ensure your university is set to generate personalized emails.', 'error');
                        return;
                    }
                    
                    btn.textContent = 'Generating...';
                    btn.disabled = true;
                    
                    try {
                        // Show loading state
                        const emailPreview = document.getElementById('email-preview');
                        const emailContent = document.getElementById('email-content');
                        
                        // Clear previous content and show loading
                        emailContent.innerHTML = `
                            <div class="flex items-center justify-center py-8">
                                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"></div>
                                <span class="ml-3 text-gray-600">AI is crafting a personalized email for ${userName} from ${userUniversity}...</span>
                            </div>
                        `;
                        emailPreview.classList.remove('hidden');
                        
                        // Make API call to Gemini
                        const response = await fetch('/api/gemini/generate-email', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                goal: goal,
                                contact: contact,
                                context: context,
                                userName: userName,
                                userUniversity: userUniversity,
                                userRole: userRole
                            })
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            // Update user info display
                            document.getElementById('user-name-display').textContent = userName;
                            document.getElementById('user-university-display').textContent = userUniversity;
                            
                            // Replace any remaining placeholders with actual user data
                            let processedEmail = data.email;
                            
                            // Replace common placeholders
                            const placeholderReplacements = {
                                '[Your Name]': userName,
                                '[Your University]': userUniversity,
                                '[Your Title]': userRole,
                                '[Your Company]': userUniversity,
                                '[Your Phone Number]': 'Available upon request',
                                '[Your LinkedIn Profile URL (Optional)]': 'Available upon request'
                            };
                            
                            // Log the replacement process for debugging
                            console.log('Original email:', data.email);
                            console.log('User data:', { userName, userUniversity, userRole });
                            console.log('Placeholder replacements:', placeholderReplacements);
                            
                            // Apply all replacements
                            Object.keys(placeholderReplacements).forEach(placeholder => {
                                const regex = new RegExp(placeholder.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
                                const before = processedEmail;
                                processedEmail = processedEmail.replace(regex, placeholderReplacements[placeholder]);
                                if (before !== processedEmail) {
                                    console.log(`Replaced "${placeholder}" with "${placeholderReplacements[placeholder]}"`);
                                }
                            });
                            
                            console.log('Processed email:', processedEmail);
                            
                            // Display processed email
                            emailContent.innerHTML = processedEmail.replace(/\n/g, '<br>');
                            
                            // Make email editable
                            emailContent.contentEditable = true;
                            emailContent.classList.add('focus:outline-none', 'focus:ring-2', 'focus:ring-indigo-500', 'p-2', 'rounded', 'min-h-[200px]');
                            
                            // Show success notification
                            showNotification(`✨ Personalized email generated for ${userName} from ${userUniversity}! You can now edit it.`, 'success');
                            
                            // Smooth scroll to preview
                            emailPreview.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'nearest' 
                            });
                        } else {
                            throw new Error(data.error || 'Failed to generate email');
                        }
                        
                    } catch (error) {
                        console.error('Error generating email:', error);
                        
                        // Show error in email content
                        const emailContent = document.getElementById('email-content');
                        emailContent.innerHTML = `
                            <div class="text-red-600 text-center py-4">
                                <i class="fas fa-exclamation-triangle text-2xl mb-2"></i>
                                <p class="font-medium">Failed to generate email</p>
                                <p class="text-sm text-gray-600 mt-1">${error.message || 'Please try again later'}</p>
                            </div>
                        `;
                        
                        // Show error notification
                        showNotification(error.message || 'Failed to generate email', 'error');
                    } finally {
                        // Reset button state
                        btn.textContent = originalText;
                        btn.disabled = false;
                    }
                }
            });
            
            // Copy email functionality
            document.getElementById('copy-email-btn').addEventListener('click', function() {
                if (checkAuth()) {
                    const emailContent = document.getElementById('email-content');
                    
                    // Check if email content is empty
                    if (!emailContent.textContent.trim()) {
                        showNotification('❌ Email content is empty. Please generate an email first.', 'error');
                        return;
                    }
                    
                    // Get the current email content (edited version)
                    const emailText = emailContent.textContent;
                    
                    navigator.clipboard.writeText(emailText).then(() => {
                        const btn = this;
                        const originalText = btn.innerHTML;
                        btn.innerHTML = '<i class="fas fa-check mr-2"></i>Copied!';
                        btn.classList.remove('bg-green-600', 'hover:bg-green-700');
                        btn.classList.add('bg-green-500');
                        
                        setTimeout(() => {
                            btn.innerHTML = originalText;
                            btn.classList.remove('bg-green-500');
                            btn.classList.add('bg-green-600', 'hover:bg-green-700');
                        }, 2000);
                        
                        showNotification('📋 Email copied to clipboard!', 'success');
                    }).catch(() => {
                        showNotification('❌ Failed to copy email. Please try again.', 'error');
                    });
                }
            });
            
            // Send email functionality
            document.getElementById('send-email-btn').addEventListener('click', function() {
                if (checkAuth()) {
                    const emailContent = document.getElementById('email-content');
                    
                    // Check if email content is empty
                    if (!emailContent.textContent.trim()) {
                        showNotification('❌ Email content is empty. Please generate an email first.', 'error');
                        return;
                    }
                    
                    // Get the current email content (edited version)
                    const emailText = emailContent.textContent;
                    
                    // Extract recipient email from the contact field
                    const contactField = document.getElementById('contact');
                    let recipientEmail = '';
                    
                    if (contactField && contactField.value) {
                        // Try to extract email from contact field
                        const emailMatch = contactField.value.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/);
                        if (emailMatch) {
                            recipientEmail = emailMatch[0];
                        }
                    }
                    
                    // If no email found in contact field, prompt user
                    if (!recipientEmail) {
                        recipientEmail = prompt('Please enter the recipient\'s email address:');
                        if (!recipientEmail) {
                            showNotification('❌ Email address is required to send email.', 'error');
                            return;
                        }
                    }
                    
                    // Construct mailto URL
                    const mailtoLink = `mailto:${recipientEmail}?subject=${encodeURIComponent('Professional Networking Request')}&body=${encodeURIComponent(emailText)}`;
                    
                    // Open default email client
                    try {
                        window.location.href = mailtoLink;
                        showNotification('📧 Opening email client...', 'success');
                    } catch (error) {
                        console.error('Error opening email client:', error);
                        showNotification('❌ Failed to open email client. Please copy the email and send manually.', 'error');
                    }
                }
            });
            
            // Quick ask modal
            document.getElementById('quick-ask-btn').addEventListener('click', function() {
                if (checkAuth()) {
                    document.getElementById('quick-ask-modal').classList.remove('hidden');
                    document.getElementById('quick-ask-modal').classList.add('flex');
                }
            });
            
            document.getElementById('close-modal-btn').addEventListener('click', function() {
                document.getElementById('quick-ask-modal').classList.add('hidden');
                document.getElementById('quick-ask-modal').classList.remove('flex');
            });
            
            // Close modal on backdrop click
            document.getElementById('quick-ask-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.add('hidden');
                    this.classList.remove('flex');
                }
            });
            
            // Notification panel
            document.getElementById('notification-btn').addEventListener('click', function() {
                if (checkAuth()) {
                    const panel = document.getElementById('notification-panel');
                    panel.classList.toggle('hidden');
                }
            });
            
            // Close notification panel when clicking outside
            document.addEventListener('click', function(e) {
                const notificationBtn = document.getElementById('notification-btn');
                const notificationPanel = document.getElementById('notification-panel');
                
                if (!notificationBtn.contains(e.target) && !notificationPanel.contains(e.target)) {
                    notificationPanel.classList.add('hidden');
                }
            });
            
            // Initialize real-time features
            initializeRealTimeFeatures();
            
            // Start demo interactions
            startDemoInteractions();
            
            // Login button removed; still update other UI parts
            updateLockedFeatures();
            updateSessionDisplay();
            updateUserDisplay();
            
            // Start session monitoring
            startSessionMonitoring();
            
            // Check if user is already logged in
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            if (isLoggedIn) {
                showPage('landing');
            }
        });
        
        // Real-time features simulation
        function initializeRealTimeFeatures() {
            // Simulate real-time question updates
            setInterval(() => {
                if (currentPage === 'questions') {
                    // Add typing indicators occasionally
                    const questions = document.querySelectorAll('#questions-feed .bg-white');
                    if (questions.length > 0 && Math.random() > 0.7) {
                        // Simulate someone typing a response
                        console.log('Someone is typing...');
                    }
                }
            }, 5000);
            
            // Simulate new notifications
            setInterval(() => {
                const badge = document.querySelector('.notification-badge');
                if (badge && Math.random() > 0.8) {
                    const currentCount = parseInt(badge.textContent);
                    badge.textContent = currentCount + 1;
                }
            }, 15000);
        }
        
        // Demo interactions
        function startDemoInteractions() {
            // Simulate live chat messages in AMA
            if (currentPage === 'ama') {
                setTimeout(() => {
                    addLiveChatMessage('John', 'J', 'What about salary negotiations?');
                }, 3000);
            }
        }
        
        function addLiveChatMessage(name, avatar, message) {
            // This would add a new chat message to the live chat
            console.log(`New message from ${name}: ${message}`);
        }
        
        // Swipe functionality for match cards
        let startX, startY, currentCard;
        
        document.addEventListener('touchstart', function(e) {
            if (e.target.closest('.swipe-card')) {
                currentCard = e.target.closest('.swipe-card');
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
            }
        });
        
        document.addEventListener('touchmove', function(e) {
            if (!currentCard) return;
            
            e.preventDefault();
            const currentX = e.touches[0].clientX;
            const currentY = e.touches[0].clientY;
            
            const diffX = currentX - startX;
            const diffY = currentY - startY;
            
            currentCard.style.transform = `translateX(${diffX}px) rotate(${diffX * 0.1}deg)`;
        });
        
        document.addEventListener('touchend', function(e) {
            if (!currentCard) return;
            
            const rect = currentCard.getBoundingClientRect();
            const cardCenter = rect.left + rect.width / 2;
            const screenCenter = window.innerWidth / 2;
            
            if (Math.abs(cardCenter - screenCenter) > 100) {
                // Card swiped far enough
                const direction = cardCenter > screenCenter ? 1 : -1;
                currentCard.style.transform = `translateX(${direction * window.innerWidth}px) rotate(${direction * 30}deg)`;
                currentCard.style.opacity = '0';
                
                setTimeout(() => {
                    if (currentCard.parentNode) {
                        currentCard.remove();
                    }
                }, 300);
            } else {
                // Snap back
                currentCard.style.transform = 'translateX(0px) rotate(0deg)';
            }
            
            currentCard = null;
        });
        
        // Gamification features
        function updateUserPoints(points) {
            // This would update user's points in the system
            console.log(`User gained ${points} points!`);
        }
        
        function showAchievement(title, description) {
            // This would show an achievement popup
            console.log(`Achievement unlocked: ${title} - ${description}`);
        }
        
        // Mock WebSocket for real-time updates
        class MockWebSocket {
            constructor() {
                this.onmessage = null;
                this.onopen = null;
                this.onclose = null;
                
                setTimeout(() => {
                    if (this.onopen) this.onopen();
                    this.startMockMessages();
                }, 1000);
            }
            
            startMockMessages() {
                const messages = [
                    { type: 'new_question', data: { title: 'How to prepare for system design interviews?', author: 'Priya' }},
                    { type: 'new_answer', data: { questionId: 1, author: 'Rohit', content: 'Focus on scalability...' }},
                    { type: 'live_chat', data: { author: 'Student123', message: 'Great explanation!' }},
                    { type: 'new_connection', data: { name: 'Arjun Patel', match: '94%' }}
                ];
                
                setInterval(() => {
                    if (this.onmessage && Math.random() > 0.7) {
                        const message = messages[Math.floor(Math.random() * messages.length)];
                        this.onmessage({ data: JSON.stringify(message) });
                    }
                }, 8000);
            }
            
            send(data) {
                console.log('Sending:', data);
            }
            
            close() {
                if (this.onclose) this.onclose();
            }
        }
        
        // Initialize mock WebSocket
        const socket = new MockWebSocket();
        socket.onmessage = function(event) {
            const message = JSON.parse(event.data);
            handleRealtimeMessage(message);
        };
        
        function handleRealtimeMessage(message) {
            switch(message.type) {
                case 'new_question':
                    if (currentPage === 'questions') {
                        console.log('New question posted:', message.data.title);
                        // Would add new question to feed
                    }
                    break;
                case 'new_answer':
                    console.log('New answer posted');
                    // Would update question with new answer
                    break;
                case 'live_chat':
                    if (currentPage === 'ama') {
                        console.log('Live chat message:', message.data.message);
                        // Would add message to chat
                    }
                    break;
                case 'new_connection':
                    console.log('New connection match:', message.data.name);
                    // Would show notification
                    break;
            }
        }
        
        // AI Features (Mock implementations)
        class AIHelper {
            static async generateEmail(goal, contact, context) {
                // Simulate AI processing time
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                return `Subject: ${goal}

Hi ${contact.split(',')[0]},

I hope this email finds you well. I'm a student at Chandigarh University and I came across your inspiring journey. 

${context}

I would greatly appreciate any guidance you could share about:
- Key skills for success in your field  
- Building a strong portfolio/resume
- Internship and career opportunities

I understand you must be busy, but even a brief conversation would be incredibly valuable.

Thank you for your time.

Best regards,
[Your Name]
Chandigarh University`;
            }
            
            static async findMatches(query) {
                // Simulate AI matching
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                return dummyUsers.filter(user => {
                    return user.expertise.some(skill => 
                        skill.toLowerCase().includes(query.toLowerCase())
                    );
                });
            }
            
            static async generateCareerInsights(domain, company) {
                // Simulate AI analysis
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                const insights = {
                    'Software Development': {
                        'Google': 'Focus on data structures, system design, and coding interviews. 85% success rate with prior startup experience.',
                        'Microsoft': 'Emphasize collaborative projects and cloud technologies. Strong behavioral interview preparation needed.'
                    },
                    'UX Design': {
                        'Adobe': 'Portfolio should showcase end-to-end design process. User research experience highly valued.',
                        'Google': 'Focus on accessibility and inclusive design. Quantify impact of design decisions.'
                    }
                };
                
                return insights[domain]?.[company] || 'Build strong fundamentals and gain practical experience through projects and internships.';
            }
            
            static async analyzeLiveSession(transcript) {
                // Simulate AI processing of AMA session
                const highlights = [
                    { type: 'insight', content: 'Focus on user impact metrics rather than just technical skills' },
                    { type: 'action', content: 'Build 2-3 case studies showing end-to-end thinking' },
                    { type: 'resource', content: 'Recommended: "Inspired" by Marty Cagan' }
                ];
                
                return highlights;
            }
        }
        
        // Advanced features
        function initializeAdvancedFeatures() {
            // Voice-to-text for questions
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                
                const voiceBtn = document.createElement('button');
                voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                voiceBtn.className = 'ml-2 p-2 text-gray-500 hover:text-indigo-600';
                
                // Add voice button to question input
                const questionInput = document.querySelector('#questions-page input');
                if (questionInput) {
                    questionInput.parentNode.appendChild(voiceBtn);
                    
                    voiceBtn.addEventListener('click', () => {
                        if (checkAuth()) {
                            recognition.start();
                            voiceBtn.innerHTML = '<i class="fas fa-stop text-red-500"></i>';
                        }
                    });
                    
                    recognition.onresult = (event) => {
                        questionInput.value = event.results[0][0].transcript;
                        voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                    };
                }
            }
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case '1':
                            e.preventDefault();
                            if (checkAuth()) showPage('landing');
                            break;
                        case '2':
                            e.preventDefault();
                            if (checkAuth()) showPage('questions');
                            break;
                        case '3':
                            e.preventDefault();
                            if (checkAuth()) showPage('connect');
                            break;
                        case '/':
                            e.preventDefault();
                            if (checkAuth()) document.getElementById('quick-ask-btn').click();
                            break;
                    }
                }
            });
            
            // Progressive Web App features
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js').catch(console.error);
            }
            
            // Install prompt
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                deferredPrompt = e;
                showInstallPrompt();
            });
        }
        
        function showInstallPrompt() {
            const installBanner = document.createElement('div');
            installBanner.className = 'fixed bottom-20 left-4 right-4 bg-indigo-600 text-white p-4 rounded-lg shadow-lg z-50';
            installBanner.innerHTML = `
                <div class="flex items-center justify-between">
                    <div>
                        <h4 class="font-semibold">Install UniConnect+</h4>
                        <p class="text-sm opacity-90">Get the full app experience</p>
                    </div>
                    <div class="flex space-x-2">
                        <button id="install-btn" class="bg-white text-indigo-600 px-4 py-2 rounded font-medium">Install</button>
                        <button id="dismiss-install" class="text-white opacity-75">✕</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(installBanner);
            
            document.getElementById('install-btn').addEventListener('click', () => {
                if (checkAuth()) {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        deferredPrompt.userChoice.then(() => {
                            deferredPrompt = null;
                            installBanner.remove();
                        });
                    }
                }
            });
            
            document.getElementById('dismiss-install').addEventListener('click', () => {
                installBanner.remove();
            });
        }
        
        // Analytics and user behavior tracking
        class Analytics {
            static trackPageView(page) {
                console.log(`Page view: ${page}`);
                // Would send to analytics service
            }
            
            static trackUserAction(action, data) {
                console.log(`User action: ${action}`, data);
                // Would send to analytics service
            }
            
            static trackEngagement(feature, duration) {
                console.log(`Engagement: ${feature} for ${duration}ms`);
                // Would send to analytics service
            }
        }
        
        // Accessibility features
        function initializeAccessibility() {
            // High contrast mode toggle
            const contrastBtn = document.createElement('button');
            contrastBtn.className = 'fixed bottom-4 left-4 w-12 h-12 bg-gray-800 text-white rounded-full shadow-lg hover:bg-gray-700 transition z-50';
            contrastBtn.innerHTML = '<i class="fas fa-adjust"></i>';
            contrastBtn.title = 'Toggle High Contrast';
            
            contrastBtn.addEventListener('click', () => {
                document.body.classList.toggle('high-contrast');
            });
            
            document.body.appendChild(contrastBtn);
            
            // Focus management
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Tab') {
                    document.body.classList.add('keyboard-navigation');
                }
            });
            
            document.addEventListener('click', () => {
                document.body.classList.remove('keyboard-navigation');
            });
            
            // Screen reader announcements
            const announcer = document.createElement('div');
            announcer.setAttribute('aria-live', 'polite');
            announcer.setAttribute('aria-atomic', 'true');
            announcer.className = 'sr-only';
            document.body.appendChild(announcer);
            
            window.announceToScreenReader = (message) => {
                announcer.textContent = message;
                setTimeout(() => announcer.textContent = '', 1000);
            };
        }
        
        // Performance optimization
        class PerformanceOptimizer {
            static lazyLoadImages() {
                const images = document.querySelectorAll('img[data-src]');
                const imageObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.removeAttribute('data-src');
                            imageObserver.unobserve(img);
                        }
                    });
                });
                
                images.forEach(img => imageObserver.observe(img));
            }
            
            static deferNonCriticalJS() {
                // Defer loading of non-critical JavaScript
                const scripts = [
                    'https://www.googletagmanager.com/gtag/js',
                    // Other non-critical scripts
                ];
                
                setTimeout(() => {
                    scripts.forEach(src => {
                        const script = document.createElement('script');
                        script.src = src;
                        script.async = true;
                        document.head.appendChild(script);
                    });
                }, 3000);
            }
            
            static preloadCriticalResources() {
                // Preload critical resources
                const criticalResources = [
                    { href: 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap', as: 'style' },
                    // Other critical resources
                ];
                
                criticalResources.forEach(resource => {
                    const link = document.createElement('link');
                    link.rel = 'preload';
                    link.href = resource.href;
                    link.as = resource.as;
                    document.head.appendChild(link);
                });
            }
        }
        
        // Error handling and offline support
        class ErrorHandler {
            static handleError(error, context) {
                console.error(`Error in ${context}:`, error);
                
                // Show user-friendly error message
                const errorToast = document.createElement('div');
                errorToast.className = 'fixed top-20 right-4 bg-red-500 text-white p-4 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform';
                errorToast.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Something went wrong. Please try again.</span>
                        <button class="ml-2 text-white opacity-75 hover:opacity-100">✕</button>
                    </div>
                `;
                
                document.body.appendChild(errorToast);
                
                // Animate in
                setTimeout(() => {
                    errorToast.classList.remove('translate-x-full');
                }, 100);
                
                // Auto dismiss
                setTimeout(() => {
                    errorToast.classList.add('translate-x-full');
                    setTimeout(() => errorToast.remove(), 300);
                }, 5000);
                
                // Manual dismiss
                errorToast.querySelector('button').addEventListener('click', () => {
                    errorToast.classList.add('translate-x-full');
                    setTimeout(() => errorToast.remove(), 300);
                });
            }
            
            static handleOffline() {
                window.addEventListener('online', () => {
                    window.announceToScreenReader('Connection restored');
                    const offlineIndicator = document.querySelector('.offline-indicator');
                    if (offlineIndicator) offlineIndicator.remove();
                });
                
                window.addEventListener('offline', () => {
                    window.announceToScreenReader('Connection lost. Some features may be limited.');
                    
                    const offlineIndicator = document.createElement('div');
                    offlineIndicator.className = 'offline-indicator fixed top-16 left-1/2 transform -translate-x-1/2 bg-yellow-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                    offlineIndicator.innerHTML = '<i class="fas fa-wifi-slash mr-2"></i>You are offline';
                    document.body.appendChild(offlineIndicator);
                });
            }
        }
        
        // Initialize all features when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize core features (already done above)
            
            // Initialize advanced features
            setTimeout(() => {
                initializeAdvancedFeatures();
                initializeAccessibility();
                PerformanceOptimizer.lazyLoadImages();
                PerformanceOptimizer.deferNonCriticalJS();
                ErrorHandler.handleOffline();
            }, 1000);
            
            // Track initial page view
            Analytics.trackPageView('landing');
        });
        
        // Question Management System
        class QuestionManager {
            constructor() {
                this.questions = [];
                this.selectedTag = null;
                this.questionCounter = 0;
                this.currentFilter = 'global'; // 'global' or 'university'
                this.init();
            }
            
            // Save questions to localStorage
            saveQuestions() {
                try {
                    localStorage.setItem('uniConnect_questions', JSON.stringify(this.questions));
                    localStorage.setItem('uniConnect_questionCounter', this.questionCounter.toString());
                } catch (error) {
                    console.error('Error saving questions:', error);
                }
            }
            
            // Load questions from localStorage
            loadQuestions() {
                try {
                    const savedQuestions = localStorage.getItem('uniConnect_questions');
                    const savedCounter = localStorage.getItem('uniConnect_questionCounter');
                    
                    if (savedQuestions) {
                        this.questions = JSON.parse(savedQuestions);
                        // Convert timestamp strings back to Date objects
                        this.questions.forEach(question => {
                            if (question.timestamp) {
                                question.timestamp = new Date(question.timestamp);
                            }
                            // Ensure likedBy array exists
                            if (!question.likedBy) {
                                question.likedBy = [];
                            }
                            // Ensure comments array exists
                            if (!question.comments) {
                                question.comments = [];
                            }
                        });
                    }
                    
                    if (savedCounter) {
                        this.questionCounter = parseInt(savedCounter);
                    }
                } catch (error) {
                    console.error('Error loading questions:', error);
                    // If there's an error, start fresh
                    this.questions = [];
                    this.questionCounter = 0;
                }
            }
            
            // Clear all questions data (for testing/reset purposes)
            clearAllData() {
                try {
                    localStorage.removeItem('uniConnect_questions');
                    localStorage.removeItem('uniConnect_questionCounter');
                    this.questions = [];
                    this.questionCounter = 0;
                    this.renderQuestions();
                    showNotification('All data cleared successfully', 'success');
                } catch (error) {
                    console.error('Error clearing data:', error);
                    showNotification('Error clearing data', 'error');
                }
            }
            
            // Get data statistics
            getDataStats() {
                const totalQuestions = this.questions.length;
                const totalLikes = this.questions.reduce((sum, q) => sum + (q.likedBy ? q.likedBy.length : 0), 0);
                const totalComments = this.questions.reduce((sum, q) => sum + (q.comments ? q.comments.length : 0), 0);
                
                return {
                    questions: totalQuestions,
                    likes: totalLikes,
                    comments: totalComments
                };
            }
            

            

            
            setupUniversityFilter() {
                const filterSelect = document.getElementById('university-filter');
                const userUniversityOption = document.getElementById('user-university-option');
                
                if (filterSelect) {
                    // Update user university option text
                    const userUniversity = localStorage.getItem('userUniversity');
                    if (userUniversity && userUniversityOption) {
                        userUniversityOption.textContent = `🎓 ${userUniversity}`;
                    }
                    
                    // Set initial filter
                    filterSelect.value = this.currentFilter;
                    
                    // Add event listener
                    filterSelect.addEventListener('change', (e) => {
                        this.currentFilter = e.target.value;
                        this.updateFilterIndicator();
                        this.renderQuestions();
                        console.log('Filter changed to:', this.currentFilter);
                    });
                    
                    // Set initial indicator
                    this.updateFilterIndicator();
                }
            }
            
            getFilteredQuestions() {
                if (this.currentFilter === 'university') {
                    const userUniversity = localStorage.getItem('userUniversity');
                    if (!userUniversity) {
                        return this.questions; // Show all if no university set
                    }
                    return this.questions.filter(question => question.university === userUniversity);
                }
                return this.questions; // Show all for global filter
            }
            
            updateFilterIndicator() {
                const filterText = document.getElementById('filter-text');
                const filterIndicator = document.getElementById('filter-indicator');
                
                if (filterText && filterIndicator) {
                    if (this.currentFilter === 'university') {
                        const userUniversity = localStorage.getItem('userUniversity');
                        filterText.textContent = userUniversity ? userUniversity.split(' ')[0] : 'University';
                        filterIndicator.className = 'px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800';
                    } else {
                        filterText.textContent = 'Global';
                        filterIndicator.className = 'px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800';
                    }
                }
            }
            
            init() {
                this.setupEventListeners();
                this.loadQuestions(); // Load saved questions first
                if (this.questions.length === 0) {
                    this.loadSampleQuestions(); // Only load sample questions if no saved data
                }
                this.setupUniversityFilter();
                this.renderQuestions();
            }
            
            setupEventListeners() {
                // Question form submission
                const questionForm = document.getElementById('question-form');
                if (questionForm) {
                    questionForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.postQuestion();
                    });
                }
                
                // Tag selection
                const tagOptions = document.querySelectorAll('.tag-option');
                tagOptions.forEach(tag => {
                    tag.addEventListener('click', () => {
                        this.selectTag(tag);
                    });
                });
                

            }
            
            selectTag(selectedTag) {
                // Remove previous selection
                document.querySelectorAll('.tag-option').forEach(tag => {
                    tag.classList.remove('ring-2', 'ring-indigo-500');
                });
                
                // Select new tag
                selectedTag.classList.add('ring-2', 'ring-indigo-500');
                this.selectedTag = selectedTag.dataset.tag;
            }
            
            postQuestion() {
                if (!checkAuth()) {
                    showNotification('Please login to post a question', 'error');
                    return;
                }
                
                const title = document.getElementById('question-title').value.trim();
                const content = document.getElementById('question-content').value.trim();
                
                if (!title || !content) {
                    showNotification('Please fill in both title and content', 'error');
                    return;
                }
                
                if (!this.selectedTag) {
                    showNotification('Please select a tag for your question', 'error');
                    return;
                }
                
                const question = {
                    id: ++this.questionCounter,
                    title: title,
                    content: content,
                    tag: this.selectedTag,
                    author: localStorage.getItem('userEmail')?.split('@')[0] || 'User',
                    authorEmail: localStorage.getItem('userEmail'), // Store full email for deletion check
                    authorInitial: localStorage.getItem('userEmail')?.charAt(0).toUpperCase() || 'U',
                    university: localStorage.getItem('userUniversity'), // Store user's university
                    timestamp: new Date(),
                    likedBy: [], // Array of user emails who liked this question
                    comments: []
                };
                
                // Ensure likedBy is always an array
                if (!question.likedBy) {
                    question.likedBy = [];
                }
                
                this.questions.unshift(question);
                this.saveQuestions(); // Save to localStorage
                this.renderQuestions();
                this.resetForm();
                
                showNotification('Question posted successfully!', 'success');
                
                // Update real-time feed
                if (socket && socket.onmessage) {
                    socket.send(JSON.stringify({
                        type: 'new_question',
                        data: question
                    }));
                }
            }
            
            resetForm() {
                document.getElementById('question-title').value = '';
                document.getElementById('question-content').value = '';
                document.querySelectorAll('.tag-option').forEach(tag => {
                    tag.classList.remove('ring-2', 'ring-indigo-500');
                });
                this.selectedTag = null;
            }
            
            renderQuestions() {
                const questionsFeed = document.getElementById('questions-feed');
                if (!questionsFeed) return;
                
                questionsFeed.innerHTML = '';
                
                const filteredQuestions = this.getFilteredQuestions();
                
                if (filteredQuestions.length === 0) {
                    const noQuestionsDiv = document.createElement('div');
                    noQuestionsDiv.className = 'text-center py-8 text-gray-500';
                    noQuestionsDiv.innerHTML = `
                        <i class="fas fa-inbox text-4xl mb-4 text-gray-300"></i>
                        <p class="text-lg font-medium">No questions found</p>
                        <p class="text-sm">${this.currentFilter === 'university' ? 'No questions from your university yet.' : 'No questions available.'}</p>
                    `;
                    questionsFeed.appendChild(noQuestionsDiv);
                } else {
                    filteredQuestions.forEach(question => {
                        const questionElement = this.createQuestionElement(question);
                        questionsFeed.appendChild(questionElement);
                    });
                }
            }
            
            createQuestionElement(question) {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-white rounded-xl shadow-md p-6 card-hover';
                questionDiv.dataset.questionId = question.id;
                
                const timeAgo = this.getTimeAgo(question.timestamp);
                const tagColors = {
                    'Career': 'bg-blue-100 text-blue-800',
                    'Academics': 'bg-green-100 text-green-800',
                    'Internships': 'bg-purple-100 text-purple-800',
                    'Placements': 'bg-yellow-100 text-yellow-800'
                };
                
                questionDiv.innerHTML = `
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-indigo-500 rounded-full flex items-center justify-center">
                                <span class="text-white text-sm font-medium">${question.authorInitial}</span>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900">${question.author}</h4>
                                <div class="flex items-center space-x-2 text-sm text-gray-600">
                                    <span>${timeAgo}</span>
                                    ${question.university ? `<span class="text-indigo-600">• ${question.university}</span>` : ''}
                                </div>
                            </div>
                        </div>
                        <span class="px-3 py-1 ${tagColors[question.tag]} text-sm rounded-full">${question.tag}</span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">${question.title}</h3>
                    <p class="text-gray-700 mb-4">${question.content}</p>
                    <div class="flex items-center space-x-6 text-sm text-gray-600">
                        <button class="like-btn flex items-center space-x-2 hover:text-red-500 transition-colors relative group ${this.isQuestionLikedByUser(question) ? 'liked' : ''}" data-question-id="${question.id}" title="${this.getLikeTooltipText(question)}">
                            <i class="fas fa-heart ${this.isQuestionLikedByUser(question) ? 'text-red-500' : 'text-gray-400'}"></i>
                            <span class="like-count">${question.likedBy ? question.likedBy.length : 0}</span>
                            ${question.likedBy && question.likedBy.length > 0 ? '<span class="like-indicator absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full"></span>' : ''}
                        </button>
                        <button class="comment-btn flex items-center space-x-2 hover:text-indigo-600 transition-colors" data-question-id="${question.id}">
                            <i class="fas fa-comment"></i>
                            <span class="comment-count">${question.comments.length}</span>
                        </button>
                        <button class="share-btn flex items-center space-x-2 hover:text-indigo-600 transition-colors">
                            <i class="fas fa-share"></i>
                            <span>Share</span>
                        </button>
                        ${this.canDeleteQuestion(question) ? `
                        <button class="delete-btn flex items-center space-x-2 hover:text-red-600 transition-colors" data-question-id="${question.id}" title="Delete this question">
                            <i class="fas fa-trash text-gray-400 hover:text-red-600"></i>
                            <span class="hidden sm:inline">Delete</span>
                        </button>
                        ` : ''}
                    </div>
                    <div class="comments-section mt-4 pt-4 border-t border-gray-200 hidden">
                        <div class="comments-list space-y-3 mb-4"></div>
                        <div class="add-comment">
                            <textarea placeholder="Write a comment..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" rows="2"></textarea>
                            <button class="post-comment-btn mt-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">Post Comment</button>
                        </div>
                    </div>
                `;
                
                // Add event listeners
                this.addQuestionEventListeners(questionDiv, question);
                
                return questionDiv;
            }
            
            addQuestionEventListeners(questionElement, question) {
                // Like button
                const likeBtn = questionElement.querySelector('.like-btn');
                if (likeBtn) {
                    console.log('Adding like event listener for question:', question.id);
                    likeBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('Like button clicked for question:', question.id);
                        this.toggleLike(question.id);
                    });
                } else {
                    console.error('Like button not found for question:', question.id);
                }
                
                // Like count click to show details
                const likeCount = questionElement.querySelector('.like-count');
                if (likeCount) {
                    likeCount.addEventListener('click', (e) => {
                        e.stopPropagation(); // Prevent triggering the like button
                        this.showLikeDetails(question);
                    });
                }
                
                // Comment button
                const commentBtn = questionElement.querySelector('.comment-btn');
                commentBtn.addEventListener('click', () => {
                    this.toggleComments(questionElement);
                });
                
                // Post comment button
                const postCommentBtn = questionElement.querySelector('.post-comment-btn');
                if (postCommentBtn) {
                    postCommentBtn.addEventListener('click', () => {
                        this.postComment(question.id, questionElement);
                    });
                }
                
                // Share button
                const shareBtn = questionElement.querySelector('.share-btn');
                shareBtn.addEventListener('click', () => {
                    this.shareQuestion(question);
                });
                
                // Delete button
                const deleteBtn = questionElement.querySelector('.delete-btn');
                if (deleteBtn) {
                    deleteBtn.addEventListener('click', () => {
                        this.deleteQuestion(question.id);
                    });
                }
            }
            
            isQuestionLikedByUser(question) {
                const userEmail = localStorage.getItem('userEmail');
                if (!userEmail || !question.likedBy) return false;
                return question.likedBy.includes(userEmail);
            }
            
            canDeleteQuestion(question) {
                const userEmail = localStorage.getItem('userEmail');
                if (!userEmail) return false;
                return question.author === userEmail.split('@')[0] || question.authorEmail === userEmail;
            }
            
            getLikeTooltipText(question) {
                if (!question.likedBy || question.likedBy.length === 0) {
                    return 'No likes yet';
                }
                
                const currentUserEmail = localStorage.getItem('userEmail');
                const isLikedByCurrentUser = question.likedBy.includes(currentUserEmail);
                
                if (question.likedBy.length === 1) {
                    if (isLikedByCurrentUser) {
                        return 'You liked this question';
                    } else {
                        return '1 person liked this question';
                    }
                } else if (question.likedBy.length === 2) {
                    if (isLikedByCurrentUser) {
                        return 'You and 1 other person liked this question';
                    } else {
                        return '2 people liked this question';
                    }
                } else {
                    const othersCount = isLikedByCurrentUser ? question.likedBy.length - 1 : question.likedBy.length;
                    if (isLikedByCurrentUser) {
                        return `You and ${othersCount} other people liked this question`;
                    } else {
                        return `${question.likedBy.length} people liked this question`;
                    }
                }
            }
            
            showLikeDetails(question) {
                if (!question.likedBy || question.likedBy.length === 0) {
                    showNotification('No likes yet', 'info');
                    return;
                }
                
                const currentUserEmail = localStorage.getItem('userEmail');
                const currentUser = currentUserEmail?.split('@')[0] || 'User';
                
                let message = `Liked by ${question.likedBy.length} people:\n\n`;
                
                question.likedBy.forEach((email, index) => {
                    const userName = email.split('@')[0];
                    if (email === currentUserEmail) {
                        message += `• ${userName} (You)\n`;
                    } else {
                        message += `• ${userName}\n`;
                    }
                });
                
                // Create a modal or use alert for now
                alert(message);
            }
            
            toggleLike(questionId) {
                console.log('toggleLike called for questionId:', questionId);
                
                // Check if user is logged in
                const userEmail = localStorage.getItem('userEmail');
                if (!userEmail) {
                    showNotification('Please login to like questions', 'error');
                    return;
                }
                
                console.log('User is logged in:', userEmail);
                
                const question = this.questions.find(q => q.id === questionId);
                if (!question) {
                    console.error('Question not found for ID:', questionId);
                    return;
                }
                
                console.log('Found question:', question);
                
                // Initialize likedBy array if it doesn't exist
                if (!question.likedBy) {
                    question.likedBy = [];
                }
                
                console.log('User email:', userEmail);
                console.log('Current likedBy array:', question.likedBy);
                
                const userLikedIndex = question.likedBy.indexOf(userEmail);
                let isLiked = false;
                
                if (userLikedIndex === -1) {
                    // User hasn't liked this question yet - add their like
                    question.likedBy.push(userEmail);
                    isLiked = true;
                } else {
                    // User has already liked this question - remove their like
                    question.likedBy.splice(userLikedIndex, 1);
                    isLiked = false;
                }
                
                // Update UI
                const questionElement = document.querySelector(`[data-question-id="${questionId}"]`);
                if (questionElement) {
                    const likeBtn = questionElement.querySelector('.like-btn');
                    if (likeBtn) {
                        const likeIcon = likeBtn.querySelector('i');
                        const likeCount = likeBtn.querySelector('.like-count');
                        const likeIndicator = likeBtn.querySelector('.like-indicator');
                        
                        if (likeIcon) {
                            // Update heart icon
                            likeIcon.className = `fas fa-heart ${isLiked ? 'text-red-500' : 'text-gray-400'}`;
                        }
                        
                        // Update like button class
                        if (isLiked) {
                            likeBtn.classList.add('liked');
                        } else {
                            likeBtn.classList.remove('liked');
                        }
                        
                        if (likeCount) {
                            // Update like count
                            likeCount.textContent = question.likedBy.length;
                        }
                        
                        // Update indicator
                        if (question.likedBy.length > 0) {
                            if (!likeIndicator) {
                                const indicator = document.createElement('span');
                                indicator.className = 'like-indicator absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full';
                                likeBtn.appendChild(indicator);
                            }
                        } else {
                            if (likeIndicator) {
                                likeIndicator.remove();
                            }
                        }
                        
                        // Update tooltip
                        likeBtn.title = this.getLikeTooltipText(question);
                        
                        console.log('UI updated - isLiked:', isLiked, 'likeCount:', question.likedBy.length);
                    } else {
                        console.error('Like button not found for question:', questionId);
                    }
                } else {
                    console.error('Question element not found for ID:', questionId);
                    // Re-render questions to ensure UI is in sync
                    this.renderQuestions();
                }
                
                // Alternative approach: Update the question in the array and re-render
                if (!questionElement || !likeBtn) {
                    console.log('Using alternative approach - re-rendering questions');
                    this.renderQuestions();
                }
                
                // Save changes to localStorage
                this.saveQuestions();
                
                showNotification(isLiked ? 'Question liked! ❤️' : 'Like removed', 'success');
            }
            
            deleteQuestion(questionId) {
                if (!checkAuth()) {
                    showNotification('Please login to delete questions', 'error');
                    return;
                }
                
                const question = this.questions.find(q => q.id === questionId);
                if (!question) {
                    showNotification('Question not found', 'error');
                    return;
                }
                
                // Check if user can delete this question
                if (!this.canDeleteQuestion(question)) {
                    showNotification('You can only delete your own questions', 'error');
                    return;
                }
                
                // Show custom confirmation modal
                this.showDeleteConfirmation(question, () => {
                    this.performDelete(questionId);
                });
                
            }
            
            performDelete(questionId) {
                // Remove question from array
                const questionIndex = this.questions.findIndex(q => q.id === questionId);
                if (questionIndex !== -1) {
                    this.questions.splice(questionIndex, 1);
                    
                    // Save to localStorage
                    this.saveQuestions();
                    
                    // Remove from UI
                    const questionElement = document.querySelector(`[data-question-id="${questionId}"]`);
                    if (questionElement) {
                        questionElement.style.opacity = '0';
                        questionElement.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            questionElement.remove();
                        }, 300);
                    }
                    
                    showNotification('Question deleted successfully', 'success');
                }
            }
            
            showDeleteConfirmation(question, onConfirm) {
                // Create modal backdrop
                const backdrop = document.createElement('div');
                backdrop.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                backdrop.id = 'delete-confirmation-modal';
                
                // Create modal content
                const modal = document.createElement('div');
                modal.className = 'bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all duration-300 scale-95 opacity-0';
                
                modal.innerHTML = `
                    <div class="p-8 text-center">
                        <!-- Warning Icon -->
                        <div class="mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-6">
                            <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
                        </div>
                        
                        <!-- Title -->
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Delete Question</h3>
                        
                        <!-- Message -->
                        <p class="text-gray-600 mb-6">
                            Are you sure you want to delete "<strong>${question.title}</strong>"?
                        </p>
                        <p class="text-sm text-gray-500 mb-8">
                            This action cannot be undone. All likes and comments will be permanently removed.
                        </p>
                        
                        <!-- Buttons -->
                        <div class="flex space-x-4">
                            <button id="cancel-delete-btn" class="flex-1 bg-gray-200 text-gray-800 py-3 px-6 rounded-lg font-semibold hover:bg-gray-300 transition-colors duration-200">
                                <i class="fas fa-times mr-2"></i>Cancel
                            </button>
                            <button id="confirm-delete-btn" class="flex-1 bg-red-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-red-700 transition-colors duration-200">
                                <i class="fas fa-trash mr-2"></i>Delete
                            </button>
                        </div>
                    </div>
                `;
                
                backdrop.appendChild(modal);
                document.body.appendChild(backdrop);
                
                // Animate modal in
                setTimeout(() => {
                    modal.classList.remove('scale-95', 'opacity-0');
                    modal.classList.add('scale-100', 'opacity-100');
                }, 10);
                
                // Add event listeners
                const cancelBtn = modal.querySelector('#cancel-delete-btn');
                const confirmBtn = modal.querySelector('#confirm-delete-btn');
                
                const closeModal = () => {
                    modal.classList.add('scale-95', 'opacity-0');
                    setTimeout(() => {
                        backdrop.remove();
                    }, 300);
                };
                
                cancelBtn.addEventListener('click', closeModal);
                confirmBtn.addEventListener('click', () => {
                    closeModal();
                    onConfirm();
                });
                
                // Close on backdrop click
                backdrop.addEventListener('click', (e) => {
                    if (e.target === backdrop) {
                        closeModal();
                    }
                });
                
                // Close on Escape key
                const handleEscape = (e) => {
                    if (e.key === 'Escape') {
                        closeModal();
                        document.removeEventListener('keydown', handleEscape);
                    }
                };
                document.addEventListener('keydown', handleEscape);
            }
            
            toggleComments(questionElement) {
                const commentsSection = questionElement.querySelector('.comments-section');
                const isHidden = commentsSection.classList.contains('hidden');
                
                if (isHidden) {
                    commentsSection.classList.remove('hidden');
                    this.loadComments(questionElement);
                } else {
                    commentsSection.classList.add('hidden');
                }
            }
            
            loadComments(questionElement) {
                const questionId = parseInt(questionElement.dataset.questionId);
                const question = this.questions.find(q => q.id === questionId);
                const commentsList = questionElement.querySelector('.comments-list');
                
                if (!question || !commentsList) return;
                
                commentsList.innerHTML = '';
                
                if (question.comments.length === 0) {
                    commentsList.innerHTML = '<p class="text-gray-500 text-sm">No comments yet. Be the first to comment!</p>';
                    return;
                }
                
                question.comments.forEach(comment => {
                    const commentElement = this.createCommentElement(comment);
                    commentsList.appendChild(commentElement);
                });
            }
            
            createCommentElement(comment) {
                const commentDiv = document.createElement('div');
                commentDiv.className = 'flex items-start space-x-3';
                
                const timeAgo = this.getTimeAgo(comment.timestamp);
                
                commentDiv.innerHTML = `
                    <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                        <span class="text-white text-xs font-medium">${comment.authorInitial}</span>
                    </div>
                    <div class="flex-1">
                        <div class="flex items-center space-x-2 mb-1">
                            <h5 class="font-medium text-gray-900 text-sm">${comment.author}</h5>
                            <span class="text-xs text-gray-600">${comment.role}</span>
                        </div>
                        <p class="text-sm text-gray-700">${comment.content}</p>
                        <div class="flex items-center space-x-4 mt-2 text-xs text-gray-500">
                            <button class="comment-like-btn hover:text-indigo-600" data-comment-id="${comment.id}">
                                👍 ${comment.likes}
                            </button>
                            <span>${timeAgo}</span>
                        </div>
                    </div>
                `;
                
                return commentDiv;
            }
            
            postComment(questionId, questionElement) {
                if (!checkAuth()) {
                    showNotification('Please login to comment', 'error');
                    return;
                }
                
                const commentTextarea = questionElement.querySelector('.add-comment textarea');
                const content = commentTextarea.value.trim();
                
                if (!content) {
                    showNotification('Please write a comment', 'error');
                    return;
                }
                
                const question = this.questions.find(q => q.id === questionId);
                if (!question) return;
                
                const comment = {
                    id: Date.now(),
                    content: content,
                    author: localStorage.getItem('userEmail')?.split('@')[0] || 'User',
                    authorInitial: localStorage.getItem('userEmail')?.charAt(0).toUpperCase() || 'U',
                    role: 'Student',
                    timestamp: new Date(),
                    likes: 0
                };
                
                question.comments.push(comment);
                
                // Update comment count
                const commentCount = questionElement.querySelector('.comment-count');
                commentCount.textContent = question.comments.length;
                
                // Reload comments
                this.loadComments(questionElement);
                
                // Clear textarea
                commentTextarea.value = '';
                
                // Save changes to localStorage
                this.saveQuestions();
                
                showNotification('Comment posted successfully!', 'success');
            }
            
            shareQuestion(question) {
                if (navigator.share) {
                    navigator.share({
                        title: question.title,
                        text: question.content,
                        url: window.location.href
                    });
                } else {
                    // Fallback: copy to clipboard
                    const textToShare = `${question.title}\n\n${question.content}\n\nShared from UniConnect+`;
                    navigator.clipboard.writeText(textToShare).then(() => {
                        showNotification('Question copied to clipboard!', 'success');
                    });
                }
            }
            
            getTimeAgo(timestamp) {
                const now = new Date();
                const diff = now - timestamp;
                const minutes = Math.floor(diff / 60000);
                const hours = Math.floor(diff / 3600000);
                const days = Math.floor(diff / 86400000);
                
                if (minutes < 1) return 'Just now';
                if (minutes < 60) return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
                if (hours < 24) return `${hours} hour${hours > 1 ? 's' : ''} ago`;
                return `${days} day${days > 1 ? 's' : ''} ago`;
            }
            

            
            loadSampleQuestions() {
                // Load initial sample questions
                const sampleQuestions = [
                    {
                        id: 1,
                        title: 'How to prepare for Google SDE interviews?',
                        content: 'I\'m in my final year and have Google interviews coming up. What should I focus on for data structures and algorithms? Any specific resources or tips from seniors who got placed?',
                        tag: 'Placements',
                        author: 'Rahul Sharma',
                        authorEmail: 'rahul@example.com',
                        authorInitial: 'R',
                        university: 'Indian Institute of Technology Bombay',
                        timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000), // 2 hours ago
                        likedBy: ['user1@example.com', 'user2@example.com', 'user3@example.com'], // Sample users who liked
                        comments: [
                            {
                                id: 1,
                                content: 'Focus on system design, practice on LeetCode daily, and don\'t forget behavioral questions. I\'d recommend "Cracking the Coding Interview" and doing mock interviews with seniors.',
                                author: 'Arjun Patel',
                                authorInitial: 'A',
                                role: 'Google SDE • Alumni',
                                timestamp: new Date(Date.now() - 1 * 60 * 60 * 1000), // 1 hour ago
                                likes: 12
                            }
                        ]
                    },
                    {
                        id: 2,
                        title: 'Best online courses for Machine Learning beginners?',
                        content: 'I want to transition into ML but don\'t know where to start. Looking for beginner-friendly courses with hands-on projects. Budget is a concern, so free or affordable options preferred.',
                        tag: 'Academics',
                        author: 'Priya Singh',
                        authorEmail: 'priya@example.com',
                        authorInitial: 'P',
                        university: 'University of Delhi',
                        timestamp: new Date(Date.now() - 4 * 60 * 60 * 1000), // 4 hours ago
                        likedBy: ['user4@example.com', 'user5@example.com'], // Sample users who liked
                        comments: []
                    },
                    {
                        id: 3,
                        title: 'Internship opportunities for Computer Science students?',
                        content: 'I\'m looking for summer internship opportunities. What are the best companies to apply to and when should I start applying? Any tips for the application process?',
                        tag: 'Internships',
                        author: 'Amit Kumar',
                        authorEmail: 'amit@example.com',
                        authorInitial: 'A',
                        university: 'Chandigarh University',
                        timestamp: new Date(Date.now() - 6 * 60 * 60 * 1000), // 6 hours ago
                        likedBy: [], // No likes yet
                        comments: []
                    },
                    {
                        id: 4,
                        title: 'Test Question - Try Liking This!',
                        content: 'This is a test question to verify that the like functionality works properly. Try clicking the heart icon to like this post!',
                        tag: 'Academics',
                        author: 'Test User',
                        authorEmail: 'test@example.com',
                        authorInitial: 'T',
                        university: 'Lovely Professional University',
                        timestamp: new Date(Date.now() - 1 * 60 * 60 * 1000), // 1 hour ago
                        likedBy: [], // No likes yet
                        comments: []
                    }
                ];
                
                this.questions = sampleQuestions;
                this.questionCounter = 4;
                this.saveQuestions(); // Save sample questions to localStorage
                this.renderQuestions();
            }
        }
        
        // Initialize question manager
        let questionManager;
        
        // Export for testing purposes
        window.UniConnectApp = {
            showPage,
            AIHelper,
            Analytics,
            ErrorHandler,
            QuestionManager,
            // Get current user info
            getCurrentUser: () => {
                const email = localStorage.getItem('userEmail');
                const university = localStorage.getItem('userUniversity');
                return { email, university };
            }
        };
        
                    // Initialize the question manager when DOM is loaded
            document.addEventListener('DOMContentLoaded', function() {
                questionManager = new QuestionManager();
                
                // Add global event delegation for like buttons as backup
                document.addEventListener('click', function(e) {
                    if (e.target.closest('.like-btn')) {
                        const likeBtn = e.target.closest('.like-btn');
                        const questionId = likeBtn.getAttribute('data-question-id');
                        if (questionId && questionManager) {
                            e.preventDefault();
                            e.stopPropagation();
                            console.log('Global like button clicked for question:', questionId);
                            questionManager.toggleLike(parseInt(questionId));
                        }
                    }
                });
            });
        
        // AMA Sessions Management
        class AMAManager {
            constructor() {
                this.socket = null;
                this.currentSession = null;
                this.isConnected = false;
                this.typingTimeout = null;
                this.init();
            }
            
            init() {
                this.initializeSocket();
                this.loadLiveSession();
                this.loadUpcomingSessions();
                this.setupEventListeners();
            }
            
            initializeSocket() {
                // Initialize Socket.IO connection
                this.socket = io('http://localhost:3000');
                
                this.socket.on('connect', () => {
                    console.log('🔌 Connected to AMA chat server');
                    this.isConnected = true;
                });
                
                this.socket.on('disconnect', () => {
                    console.log('🔌 Disconnected from AMA chat server');
                    this.isConnected = false;
                });
                
                this.socket.on('new-message', (message) => {
                    this.addChatMessage(message);
                });
                
                this.socket.on('user-typing', (data) => {
                    this.showTypingIndicator(data.userName, data.isTyping);
                });
                
                this.socket.on('user-joined', (data) => {
                    this.addSystemMessage(`${data.userName} joined the session`);
                });
                
                this.socket.on('user-left', (data) => {
                    this.addSystemMessage(`${data.userName} left the session`);
                });
            }
            
            async loadLiveSession() {
                try {
                    const response = await fetch('/api/ama/live');
                    const data = await response.json();
                    
                    if (data.isLive) {
                        this.currentSession = data.session;
                        this.showLiveSession(data.session);
                        this.loadChatHistory(data.session.id);
                        this.joinChatSession(data.session.id);
                    } else {
                        this.hideLiveSession();
                    }
                } catch (error) {
                    console.error('Error loading live session:', error);
                    this.hideLiveSession();
                }
            }
            
            async loadUpcomingSessions() {
                try {
                    const response = await fetch('/api/ama/upcoming');
                    const data = await response.json();
                    
                    this.renderUpcomingSessions(data.sessions);
                } catch (error) {
                    console.error('Error loading upcoming sessions:', error);
                    this.showNoUpcomingSessions();
                }
            }
            
            showLiveSession(session) {
                // Hide no live session message
                document.getElementById('no-live-session').classList.add('hidden');
                
                // Show live session container
                const container = document.getElementById('live-session-container');
                container.classList.remove('hidden');
                
                // Update session details
                document.getElementById('live-session-title').textContent = session.title;
                document.getElementById('live-session-host').textContent = `with ${session.host.name} • ${session.host.role}`;
                document.getElementById('live-session-watchers').textContent = `👥 ${session.registeredCount} watching`;
                
                // Calculate time since start
                const startTime = new Date(session.startTime);
                const now = new Date();
                const diffMs = now - startTime;
                const diffMins = Math.floor(diffMs / (1000 * 60));
                document.getElementById('live-session-time').textContent = `Started ${diffMins} mins ago`;
                
                // Show chat interface
                document.getElementById('live-chat-container').classList.remove('hidden');
                document.getElementById('chat-input-container').classList.remove('hidden');
                document.getElementById('chat-disabled').classList.add('hidden');
                
                // Setup join session button
                const joinBtn = document.getElementById('join-session-btn');
                joinBtn.onclick = () => {
                    if (session.meetingLink) {
                        // Show notification with meeting link
                        showNotification(`🔗 Joining: ${session.title}\n📅 Meeting Link: ${session.meetingLink}`, 'info');
                        
                        // Open meeting in new tab
                        window.open(session.meetingLink, '_blank');
                    }
                };
            }
            
            hideLiveSession() {
                document.getElementById('live-session-container').classList.add('hidden');
                document.getElementById('no-live-session').classList.remove('hidden');
                document.getElementById('live-chat-container').classList.add('hidden');
                document.getElementById('chat-input-container').classList.add('hidden');
                document.getElementById('chat-disabled').classList.remove('hidden');
            }
            
            renderUpcomingSessions(sessions) {
                const container = document.getElementById('upcoming-sessions-container');
                const loading = document.getElementById('upcoming-sessions-loading');
                const noSessions = document.getElementById('no-upcoming-sessions');
                
                loading.classList.add('hidden');
                
                if (sessions.length === 0) {
                    noSessions.classList.remove('hidden');
                    return;
                }
                
                noSessions.classList.add('hidden');
                
                container.innerHTML = sessions.map(session => `
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center">
                                    <span class="text-white font-medium text-sm">${session.host.avatar || session.host.name.charAt(0)}</span>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-900">${session.title}</h4>
                                    <p class="text-sm text-gray-600">with ${session.host.name} • ${session.host.role}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-medium text-gray-900">${this.formatSessionTime(session.startTime)}</p>
                                <p class="text-xs text-gray-500">${session.registeredCount} registered</p>
                            </div>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">${session.description}</p>
                        <div class="flex items-center justify-between">
                            <button 
                                class="register-session-btn bg-indigo-100 text-indigo-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-indigo-200 transition"
                                data-session-id="${session.id}"
                                data-session-title="${session.title}"
                            >
                                Register
                            </button>
                            ${session.meetingLink ? `<a href="${session.meetingLink}" target="_blank" class="text-blue-600 hover:text-blue-800 text-sm underline" onclick="showNotification('🔗 Opening meeting link for: ${session.title}', 'info')">🔗 Meeting Link</a>` : ''}
                        </div>
                    </div>
                `).join('');
                
                // Add event listeners to register buttons
                container.querySelectorAll('.register-session-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const sessionId = e.target.getAttribute('data-session-id');
                        const sessionTitle = e.target.getAttribute('data-session-title');
                        this.registerForSession(sessionId, sessionTitle);
                    });
                });
            }
            
            showNoUpcomingSessions() {
                document.getElementById('upcoming-sessions-loading').classList.add('hidden');
                document.getElementById('no-upcoming-sessions').classList.remove('hidden');
            }
            
            async registerForSession(sessionId, sessionTitle) {
                try {
                    const userEmail = localStorage.getItem('userEmail');
                    const userName = userEmail ? userEmail.split('@')[0] : 'User';
                    
                    const response = await fetch(`/api/ama/register/${sessionId}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            userId: userEmail || 'anonymous',
                            userName: userName,
                            userEmail: userEmail || 'anonymous@example.com'
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        // Enhanced notification with date/time and meeting link
                        const sessionDate = new Date(data.session.startTime);
                        const formattedDate = sessionDate.toLocaleDateString('en-US', { 
                            weekday: 'long', 
                            year: 'numeric', 
                            month: 'long', 
                            day: 'numeric' 
                        });
                        const formattedTime = sessionDate.toLocaleTimeString('en-US', { 
                            hour: '2-digit', 
                            minute: '2-digit' 
                        });
                        
                        const notificationMessage = `✅ Successfully registered for "${sessionTitle}"!\n📅 Date: ${formattedDate}\n🕐 Time: ${formattedTime}\n🔗 Meeting Link: ${data.session.meetingLink}`;
                        
                        showNotification(notificationMessage, 'success');
                        
                        // Show detailed success modal with meeting information
                        this.showRegistrationSuccessModal(data.session, sessionTitle);
                        
                        // Update the register button
                        const btn = document.querySelector(`[data-session-id="${sessionId}"]`);
                        if (btn) {
                            btn.textContent = 'Registered ✓';
                            btn.classList.remove('bg-indigo-100', 'text-indigo-700', 'hover:bg-indigo-200');
                            btn.classList.add('bg-green-100', 'text-green-700');
                            btn.disabled = true;
                        }
                        
                        // Reload upcoming sessions to update counts
                        this.loadUpcomingSessions();
                    } else {
                        showNotification(data.error || 'Registration failed', 'error');
                    }
                } catch (error) {
                    console.error('Error registering for session:', error);
                    showNotification('Failed to register for session', 'error');
                }
            }
            
            async loadChatHistory(sessionId) {
                try {
                    const response = await fetch(`/api/chat/messages/${sessionId}`);
                    const data = await response.json();
                    
                    const chatContainer = document.getElementById('chat-messages');
                    chatContainer.innerHTML = '';
                    
                    data.messages.forEach(message => {
                        this.addChatMessage(message);
                    });
                    
                    // Scroll to bottom
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                } catch (error) {
                    console.error('Error loading chat history:', error);
                }
            }
            
            joinChatSession(sessionId) {
                if (this.socket && this.isConnected) {
                    const userEmail = localStorage.getItem('userEmail');
                    const userName = userEmail ? userEmail.split('@')[0] : 'Anonymous';
                    
                    this.socket.emit('join-session', {
                        sessionId: sessionId,
                        userId: userEmail || 'anonymous',
                        userName: userName
                    });
                }
            }
            
            addChatMessage(message) {
                const chatContainer = document.getElementById('chat-messages');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'flex items-start space-x-2';
                
                const avatarColor = this.getAvatarColor(message.userName);
                const isHost = message.isHostMessage || message.userRole === 'Product Manager';
                
                messageDiv.innerHTML = `
                    <div class="w-6 h-6 ${avatarColor} rounded-full flex items-center justify-center">
                        <span class="text-white text-xs">${message.userName.charAt(0)}</span>
                    </div>
                    <div>
                        <p class="text-sm">
                            <span class="font-medium ${isHost ? 'text-green-600' : ''}">${message.userName}${isHost ? ' (Host)' : ''}:</span> 
                            ${message.message}
                        </p>
                        <p class="text-xs text-gray-500">${this.formatMessageTime(message.timestamp)}</p>
                    </div>
                `;
                
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
            
            addSystemMessage(message) {
                const chatContainer = document.getElementById('chat-messages');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'text-center py-2';
                messageDiv.innerHTML = `
                    <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">${message}</span>
                `;
                
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
            
            showTypingIndicator(userName, isTyping) {
                const indicator = document.getElementById('typing-indicator');
                const typingUser = document.getElementById('typing-user');
                
                if (isTyping) {
                    typingUser.textContent = userName;
                    indicator.classList.remove('hidden');
                } else {
                    indicator.classList.add('hidden');
                }
            }
            
            getAvatarColor(userName) {
                const colors = [
                    'bg-blue-500', 'bg-green-500', 'bg-purple-500', 'bg-red-500', 
                    'bg-yellow-500', 'bg-indigo-500', 'bg-pink-500', 'bg-gray-500'
                ];
                const index = userName.charCodeAt(0) % colors.length;
                return colors[index];
            }
            
            formatMessageTime(timestamp) {
                const date = new Date(timestamp);
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / (1000 * 60));
                
                if (diffMins < 1) return 'Just now';
                if (diffMins < 60) return `${diffMins} min${diffMins > 1 ? 's' : ''} ago`;
                
                const diffHours = Math.floor(diffMins / 60);
                if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
                
                return date.toLocaleDateString();
            }
            
            formatSessionTime(timestamp) {
                const date = new Date(timestamp);
                const now = new Date();
                const diffMs = date - now;
                const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                
                if (diffDays === 0) return 'Today, ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                if (diffDays === 1) return 'Tomorrow, ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                if (diffDays < 7) return date.toLocaleDateString([], { weekday: 'long', hour: '2-digit', minute: '2-digit' });
                
                return date.toLocaleDateString([], { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
            }
            
            setupEventListeners() {
                // Chat input handling
                const chatInput = document.getElementById('chat-input');
                const sendBtn = document.getElementById('send-message-btn');
                
                if (chatInput && sendBtn) {
                    sendBtn.addEventListener('click', () => {
                        this.sendMessage();
                    });
                    
                    chatInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            this.sendMessage();
                        }
                    });
                    
                    // Typing indicator
                    chatInput.addEventListener('input', () => {
                        this.handleTyping();
                    });
                }
            }
            
            sendMessage() {
                const chatInput = document.getElementById('chat-input');
                const message = chatInput.value.trim();
                
                if (!message || !this.currentSession) return;
                
                const userEmail = localStorage.getItem('userEmail');
                const userName = userEmail ? userEmail.split('@')[0] : 'Anonymous';
                const userRole = localStorage.getItem('userRole') || 'Student';
                
                if (this.socket && this.isConnected) {
                    this.socket.emit('send-message', {
                        sessionId: this.currentSession.id,
                        userId: userEmail || 'anonymous',
                        userName: userName,
                        message: message,
                        userRole: userRole
                    });
                    
                    // Clear input
                    chatInput.value = '';
                    
                    // Stop typing indicator
                    this.handleTypingStop();
                }
            }
            
            handleTyping() {
                if (this.socket && this.isConnected && this.currentSession) {
                    const userEmail = localStorage.getItem('userEmail');
                    const userName = userEmail ? userEmail.split('@')[0] : 'Anonymous';
                    
                    this.socket.emit('typing', {
                        sessionId: this.currentSession.id,
                        userName: userName,
                        isTyping: true
                    });
                    
                    // Clear existing timeout
                    if (this.typingTimeout) {
                        clearTimeout(this.typingTimeout);
                    }
                    
                    // Set new timeout to stop typing indicator
                    this.typingTimeout = setTimeout(() => {
                        this.handleTypingStop();
                    }, 1000);
                }
            }
            
            handleTypingStop() {
                if (this.socket && this.isConnected && this.currentSession) {
                    const userEmail = localStorage.getItem('userEmail');
                    const userName = userEmail ? userEmail.split('@')[0] : 'Anonymous';
                    
                    this.socket.emit('typing', {
                        sessionId: this.currentSession.id,
                        userName: userName,
                        isTyping: false
                    });
                }
            }
            
            async loadHighlights(sessionId) {
                try {
                    const response = await fetch(`/api/ama/highlights/${sessionId}`);
                    const data = await response.json();
                    
                    this.renderHighlights(data.highlights);
                } catch (error) {
                    console.error('Error loading highlights:', error);
                }
            }
            
            renderHighlights(highlights) {
                const container = document.getElementById('highlights-container');
                const content = document.getElementById('highlights-content');
                const loading = document.getElementById('highlights-loading');
                const noHighlights = document.getElementById('no-highlights');
                
                // Hide no highlights message
                noHighlights.classList.add('hidden');
                
                // Show highlights container
                container.classList.remove('hidden');
                
                // Hide loading
                loading.classList.add('hidden');
                
                // Render highlights
                content.innerHTML = `
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3">
                        <h4 class="font-medium text-gray-900 text-sm">Key Insight</h4>
                        <p class="text-xs text-gray-700 mt-1">"${highlights.keyInsight}"</p>
                    </div>
                    <div class="bg-blue-50 border-l-4 border-blue-400 p-3">
                        <h4 class="font-medium text-gray-900 text-sm">Action Item</h4>
                        <p class="text-xs text-gray-700 mt-1">"${highlights.actionItem}"</p>
                    </div>
                    <div class="bg-green-50 border-l-4 border-green-400 p-3">
                        <h4 class="font-medium text-gray-900 text-sm">Resource</h4>
                        <p class="text-xs text-gray-700 mt-1">${highlights.resource}</p>
                    </div>
                `;
            }
            
            showRegistrationSuccessModal(session, sessionTitle) {
                // Create modal HTML
                const modalHTML = `
                    <div id="registration-success-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
                        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
                            <div class="mt-3 text-center">
                                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100">
                                    <svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                </div>
                                <h3 class="text-lg font-medium text-gray-900 mt-4">Registration Successful!</h3>
                                <div class="mt-4 text-left">
                                    <p class="text-sm text-gray-600 mb-3"><strong>Session:</strong> ${sessionTitle}</p>
                                    <p class="text-sm text-gray-600 mb-3"><strong>Date:</strong> ${new Date(session.startTime).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
                                    <p class="text-sm text-gray-600 mb-3"><strong>Time:</strong> ${new Date(session.startTime).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}</p>
                                    <p class="text-sm text-gray-600 mb-4"><strong>Meeting Link:</strong> <a href="${session.meetingLink}" target="_blank" class="text-blue-600 hover:text-blue-800 underline">${session.meetingLink}</a></p>
                                </div>
                                <div class="flex space-x-3 mt-6">
                                    <button onclick="this.closest('#registration-success-modal').remove()" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition">
                                        Close
                                    </button>
                                    <button onclick="window.open('${session.meetingLink}', '_blank')" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                                        Join Meeting
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Add modal to body
                document.body.insertAdjacentHTML('beforeend', modalHTML);
                
                // Auto-remove modal after 10 seconds
                setTimeout(() => {
                    const modal = document.getElementById('registration-success-modal');
                    if (modal) {
                        modal.remove();
                    }
                }, 10000);
            }
        }
        
        // Initialize AMA Manager when DOM is loaded
        let amaManager;
        document.addEventListener('DOMContentLoaded', function() {
            // ... existing code ...
            
            // Initialize AMA Manager
            amaManager = new AMAManager();
        });
        
        console.log('🚀 UniConnect+ loaded successfully!');
        console.log('Features: Real-time chat, AI email generation, smart matching, career timeline, AMA sessions, micro-mentorship, dynamic Q&A system');
    </script>
</body>
</html>